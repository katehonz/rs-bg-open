# –ù–ê–ü –î–î–° –µ–∫—Å–ø–æ—Ä—Ç —Ä–∞–∑–∫—Ä–∏—Ç: –ö–∞–∫ —Ä–µ—à–∏—Ö–º–µ 30-–≥–æ–¥–∏—à–µ–Ω —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±–ª–µ–º

*–ü—É–±–ª–∏–∫—É–≤–∞–Ω–æ –Ω–∞ 11 –æ–∫—Ç–æ–º–≤—Ä–∏ 2025*

## –ü—Ä–µ–¥–∏—Å—Ç–æ—Ä–∏–µ: DOS —Ñ–æ—Ä–º–∞—Ç—ä—Ç, –∫–æ–π—Ç–æ –≤—Å–µ –æ—â–µ —É–ø—Ä–∞–≤–ª—è–≤–∞ –±—ä–ª–≥–∞—Ä—Å–∫–æ—Ç–æ —Å—á–µ—Ç–æ–≤–æ–¥—Å—Ç–≤–æ

–ü—Ä–µ–¥—Å—Ç–∞–≤–µ—Ç–µ —Å–∏ —Å–ª–µ–¥–Ω–∞—Ç–∞ –∫–∞—Ä—Ç–∏–Ω–∞: –í—Å–µ–∫–∏ –º–µ—Å–µ—Ü –¥–æ 14-—Ç–æ —á–∏—Å–ª–æ **—Å—Ç–æ—Ç–∏—Ü–∏ —Ö–∏–ª—è–¥–∏** –±—ä–ª–≥–∞—Ä—Å–∫–∏ —Å—á–µ—Ç–æ–≤–æ–¥–∏—Ç–µ–ª–∏ —Å–µ–¥—è—Ç —Å —É–∂–∞—Å –ø—Ä–µ–¥ –∫–æ–º–ø—é—Ç—Ä–∏—Ç–µ —Å–∏, –æ–ø–∏—Ç–≤–∞–π–∫–∏ —Å–µ –¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞—Ç —Ç—Ä–∏ —Ç–µ–∫—Å—Ç–æ–≤–∏ —Ñ–∞–π–ª–∞ –∑–∞ –ù–ê–ü. –§–∞–π–ª–æ–≤–µ —Å –Ω–µ–ø–æ–Ω—è—Ç–µ–Ω —Ñ–æ—Ä–º–∞—Ç, –∞—Ä—Ö–∞–∏—á–µ–Ω encoding, —Ñ–∏–∫—Å–∏—Ä–∞–Ω–∞ –¥—ä–ª–∂–∏–Ω–∞ –Ω–∞ –ø–æ–ª–µ—Ç–∞—Ç–∞. –§–∞–π–ª–æ–≤–µ, —á–∏—è—Ç–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –µ —Å—ä–∑–¥–∞–¥–µ–Ω–∞ **–≤ —Å—Ä–µ–¥–∞—Ç–∞ –Ω–∞ 90-—Ç–µ –≥–æ–¥–∏–Ω–∏** - –ø—Ä–µ–∑ DOS –µ—Ä–∞—Ç–∞.

### –ü–∞—Ä–∞–¥–æ–∫—Å—ä—Ç –Ω–∞ –º–æ–¥–µ—Ä–Ω–æ—Å—Ç—Ç–∞

–ò –µ—Ç–æ –ø–∞—Ä–∞–¥–æ–∫—Å–∞ –Ω–∞ –Ω–∞—à–µ—Ç–æ –≤—Ä–µ–º–µ:

**AI –∏–º–ø–æ—Ä—Ç –Ω–∞ –±–∞–Ω–∫–æ–≤–∏ XML —Ñ–∞–π–ª–æ–≤–µ:**
- –í—Ä–µ–º–µ –∑–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è: **5-6 –º–∏–Ω—É—Ç–∏**
- –¢–µ—Å—Ç–≤–∞–Ω–µ: **–Ω–µ –µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ** - —Ä–∞–±–æ—Ç–∏ –æ—Ç –ø—ä—Ä–≤–∏—è –ø—ä—Ç
- –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è: –ú–æ–¥–µ—Ä–µ–Ω XML —Å—ä—Å —Å—Ö–µ–º–∞, UTF-8, –ª–æ–≥–∏—á–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- AI —Ä–∞–∑–±–∏—Ä–∞ —Ñ–æ—Ä–º–∞—Ç–∞ **–º–∏–≥–Ω–æ–≤–µ–Ω–æ**

**–ù–ê–ü –î–î–° –µ–∫—Å–ø–æ—Ä—Ç:**
- –í—Ä–µ–º–µ –∑–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è: **2 –º–µ—Å–µ—Ü–∞** –º—ä—á–∏—Ç–µ–ª–Ω–æ –º–∏—Å–ª–µ–Ω–µ
- Debugging: –ë–µ–∑–∫—Ä–∞–π–Ω–∏ –æ–ø–∏—Ç–∏ –∏ –≥—Ä–µ—à–∫–∏
- –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è: DOS —Ñ–æ—Ä–º–∞—Ç –æ—Ç 90-—Ç–µ, Windows-1251, –º–∏—Å—Ç–µ—Ä–∏–æ–∑–Ω–∏ –ø—Ä–∞–≤–∏–ª–∞
- –î–æ—Ä–∏ AI –Ω–µ –º–æ–∂–µ –¥–∞ –≥–æ —Ä–∞–∑–±–µ—Ä–µ –±–µ–∑ –ø–æ–¥—Ä–æ–±–Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

–ö–∞–∫ –µ –≤—ä–∑–º–æ–∂–Ω–æ –≤ 2025 –≥–æ–¥–∏–Ω–∞ **AI –¥–∞ –ø–∞—Ä—Å–≤–∞ —Å–ª–æ–∂–Ω–∏ –±–∞–Ω–∫–æ–≤–∏ XML-–∏ –∑–∞ –º–∏–Ω—É—Ç–∏**, –Ω–æ –¥–∞ —Å–µ –±–æ—Ä–∏ **–º–µ—Å–µ—Ü–∏** —Å –ø—Ä–∏–º–∏—Ç–∏–≤–µ–Ω —Ç–µ–∫—Å—Ç–æ–≤ —Ñ–æ—Ä–º–∞—Ç –æ—Ç DOS –µ—Ä–∞—Ç–∞? –û—Ç–≥–æ–≤–æ—Ä—ä—Ç –µ –ø—Ä–æ—Å—Ç: **–ª–∏–ø—Å–∞—Ç–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –∞–±—Å—É—Ä–¥–Ω–æ—Å—Ç –Ω–∞ —Ñ–æ—Ä–º–∞—Ç–∞**.

–ò –¥–æ–∫–∞—Ç–æ –ï–≤—Ä–æ–ø–∞ –≤—ä–≤–µ–¥–µ **SAF-T** (Standard Audit File for Tax) —Å –∫—Ä–∞—Å–∏–≤–∏ XML —Å—Ö–µ–º–∏, –ø—ä–ª–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –ø—É–±–ª–∏—á–Ω–∏ –æ–±—Å—ä–∂–¥–∞–Ω–∏—è —Å –±—Ä–∞–Ω—à–∞, –≤ –ë—ä–ª–≥–∞—Ä–∏—è –ø—Ä–æ–¥—ä–ª–∂–∞–≤–∞–º–µ –¥–∞ —Ä–∞–±–æ—Ç–∏–º —Å —Ñ–æ—Ä–º–∞—Ç, –∫–æ–π—Ç–æ –∏–∑–≥–ª–µ–∂–¥–∞ —Ç–∞–∫–∞:

```
BG123456789    –ü–†–ò–ú–ï–†–ù–ê –§–ò–†–ú–ê –û–û–î                                                              20251000000000001400000000000234  1200000.00   240000.00  1200000.00  1200000.00   240000.00         0.00...
```

**–ö–∞–∫–≤–æ –µ —Ç–æ–≤–∞?** –¢–æ–≤–∞ –µ –µ–¥–∏–Ω —Ä–µ–¥ –æ—Ç DEKLAR.TXT - –±–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏, –±–µ–∑ –∫–æ–ª–æ–Ω–∏, –±–µ–∑ –ª–æ–≥–∏–∫–∞ –∑–∞ —á–æ–≤–µ–∫ –æ—Ç 2025 –≥–æ–¥–∏–Ω–∞.

## –ó–∞—â–æ —Ç–æ–∑–∏ —Ñ–æ—Ä–º–∞—Ç –µ –ø—Ä–æ–±–ª–µ–º?

### 1. –õ–∏–ø—Å–∞ –Ω–∞ –ø—É–±–ª–∏—á–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–í –º–∏–Ω–∞–ª–æ—Ç–æ –µ–∫—Å–ø–µ—Ä—Ç–∏ –æ—Ç –ù–ê–ü **–ø—Ä–æ–≤–µ–∂–¥–∞—Ö–∞ –ø–ª–∞—Ç–µ–Ω–∏ —Å–µ–º–∏–Ω–∞—Ä–∏** —Å—ä—Å —Å–æ—Ñ—Ç—É–µ—Ä–Ω–∏ —Ñ–∏—Ä–º–∏ –∏ –≤–∑–∏–º–∞—Ö–∞ **–ª–µ–∫—Ç–æ—Ä—Å–∫–∏ —Ö–æ–Ω–æ—Ä–∞—Ä–∏**, –∑–∞ –¥–∞ –æ–±—è—Å–Ω—è—Ç –∫–∞–∫ —Å–µ –≥–µ–Ω–µ—Ä–∏—Ä–∞—Ç —Ç–µ–∑–∏ —Ñ–∞–π–ª–æ–≤–µ. –ö–∞–∫ —Å–µ –ø—Ä–∞–≤—è—Ç –î–î–° —Ñ–∞–π–ª–æ–≤–µ—Ç–µ –±–µ—à–µ —Ç–µ–º–∞ **—Ç–∞–±—É** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–∞–º–æ –∑–∞ "–∏–∑–±—Ä–∞–Ω–∏—Ç–µ" –≥–æ–ª–µ–º–∏ —Å–æ—Ñ—Ç—É–µ—Ä–Ω–∏ –∫—ä—â–∏.

–ù—è–º–∞ –æ—Ñ–∏—Ü–∏–∞–ª–Ω–∞ XML —Å—Ö–µ–º–∞. –ù—è–º–∞ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä. –ù—è–º–∞ –ø—É–±–ª–∏—á–Ω–æ API –∑–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞. –ü—Ä–æ—Å—Ç–æ –∫–∞—á–≤–∞—à —Ñ–∞–π–ª –≤ –ø–æ—Ä—Ç–∞–ª–∞ –Ω–∞ –ù–ê–ü –∏ **—Å–µ –Ω–∞–¥—è–≤–∞—à** –¥–∞ –Ω–µ –ø–æ–ª—É—á–∏—à –≥—Ä–µ—à–∫–∞.

### 2. DOS —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è –æ—Ç 90-—Ç–µ

–§–æ—Ä–º–∞—Ç—ä—Ç –µ –ø—Ä–æ–µ–∫—Ç–∏—Ä–∞–Ω –∑–∞ –≤—Ä–µ–º–µ–Ω–∞, –∫–æ–≥–∞—Ç–æ:
- –ö–æ–º–ø—é—Ç—Ä–∏—Ç–µ –∏–º–∞—Ö–∞ 640KB RAM
- Windows –±–µ—à–µ "–æ–±–≤–∏–≤–∫–∞" –Ω–∞–¥ DOS
- –ö–∏—Ä–∏–ª–∏—Ü–∞—Ç–∞ —Å–µ –∫–æ–¥–∏—Ä–∞—à–µ –≤ **Windows-1251** (Codepage 1251)
- –§–∞–π–ª–æ–≤–µ—Ç–µ —Å–µ –∫–∞—á–≤–∞—Ö–∞ –Ω–∞ **–¥–∏—Å–∫–µ—Ç–∏ 3.5"**
- Internet Explorer 3.0 –±–µ—à–µ "–º–æ–¥–µ—Ä–µ–Ω –±—Ä–∞—É–∑—ä—Ä"

**30 –≥–æ–¥–∏–Ω–∏ –ø–æ-–∫—ä—Å–Ω–æ** –Ω–∏–µ –≤—Å–µ –æ—â–µ –≥–µ–Ω–µ—Ä–∏—Ä–∞–º–µ —Å—ä—â–∏—Ç–µ DOS —Ñ–∞–π–ª–æ–≤–µ!

### 3. –§–∏–∫—Å–∏—Ä–∞–Ω–∞ –¥—ä–ª–∂–∏–Ω–∞ = –∫–æ—à–º–∞—Ä –∑–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏—Ü–∏

–í—Å—è–∫–æ –ø–æ–ª–µ –∏–º–∞ **—Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –±—Ä–æ–π —Å–∏–º–≤–æ–ª–∏**. –ù–µ 14, –Ω–µ 16 - —Ç–æ—á–Ω–æ **15 —Å–∏–º–≤–æ–ª–∞ –∑–∞ –î–î–° –Ω–æ–º–µ—Ä**. –ê–∫–æ —Å–ª–æ–∂–∏—à 14 - –≥—Ä–µ—à–∫–∞. –ê–∫–æ —Å–ª–æ–∂–∏—à 16 - –≥—Ä–µ—à–∫–∞. –ê–∫–æ –∑–∞–±—Ä–∞–≤–∏—à –¥–∞ –¥–æ–ø—ä–ª–Ω–∏—à —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏ - –≥—Ä–µ—à–∫–∞.

```rust
// –§–æ—Ä–º–∞—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –î–î–° –Ω–æ–º–µ—Ä - –¢–û–ß–ù–û 15 —Å–∏–º–≤–æ–ª–∞
let vat = "BG123456789";
let formatted = format!("{:<15}", vat);  // "BG123456789    " (—Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏)
```

### 4. Windows-1251 –≤ Unicode –µ—Ä–∞—Ç–∞

2025 –≥–æ–¥–∏–Ω–∞. –¶—è–ª–∞—Ç–∞ –ø–ª–∞–Ω–µ—Ç–∞ –∏–∑–ø–æ–ª–∑–≤–∞ UTF-8. –ë—Ä–∞—É–∑—ä—Ä–∏—Ç–µ, –±–∞–∑–∏—Ç–µ –¥–∞–Ω–Ω–∏, API-—Ç–∞—Ç–∞ - –≤—Å–∏—á–∫–æ –µ Unicode.

–ù–ê–ü –æ–±–∞—á–µ –∏—Å–∫–∞ **Windows-1251** (CP-1251). –ó–∞—â–æ? –ó–∞—â–æ—Ç–æ —Ç–∞–∫–∞ –µ –±–∏–ª–æ –≤ DOS.

```bash
# –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è–≤–∞—à –¥–∞–ª–∏ —Ñ–∞–π–ª—ä—Ç –µ –ø—Ä–∞–≤–∏–ª–µ–Ω?
file -bi DEKLAR.TXT
# –¢—Ä—è–±–≤–∞ –¥–∞ –≤–∏–¥–∏—à: text/plain; charset=windows-1251

# –ê–∫–æ –≤–∏–¥–∏—à UTF-8 - —Ñ–∞–π–ª—ä—Ç –µ –≥—Ä–µ—à–µ–Ω, –ù–ê–ü —â–µ –≥–æ –æ—Ç—Ö–≤—ä—Ä–ª–∏
```

## –†–∞–∑–∫—Ä–∏–≤–∞–º–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è—Ç–∞: –ö–∞–∫ —Ç–æ—á–Ω–æ —Ä–∞–±–æ—Ç–∏ —Ñ–æ—Ä–º–∞—Ç—ä—Ç?

–¢—ä–π –∫–∞—Ç–æ –ù–ê–ü –Ω–∏–∫–æ–≥–∞ –Ω–µ –µ –ø—É–±–ª–∏–∫—É–≤–∞–ª –ø—ä–ª–Ω–∞, –¥–æ—Å—Ç—ä–ø–Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è, –Ω–∏–µ —è —Å—ä–∑–¥–∞–¥–æ—Ö–º–µ —Å–∞–º–∏ —á—Ä–µ–∑ **reverse engineering** –∏ **–∞–Ω–∞–ª–∏–∑ –Ω–∞ —Ä–∞–±–æ—Ç–µ—â–∏ —Ñ–∞–π–ª–æ–≤–µ**. –°–µ–≥–∞ —è –ø—Ä–∞–≤–∏–º **–Ω–∞–ø—ä–ª–Ω–æ –ø—É–±–ª–∏—á–Ω–∞** –∑–∞ –±–ª–∞–≥–æ—Ç–æ –Ω–∞ –±—ä–ª–≥–∞—Ä—Å–∫–æ—Ç–æ –æ–±—â–µ—Å—Ç–≤–æ.

### –§–∞–π–ª 1: DEKLAR.TXT

**–ï–¥–∏–Ω –∑–∞–ø–∏—Å** —Å –æ–±–æ–±—â–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è—Ç–∞.

| –ü–æ–∑–∏—Ü–∏—è | –î—ä–ª–∂–∏–Ω–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---------|---------|-----|----------|--------|
| 1-15 | 15 | —Ç–µ–∫—Å—Ç | –î–î–° –Ω–æ–º–µ—Ä | `BG123456789    ` |
| 16-95 | 80 | —Ç–µ–∫—Å—Ç | –ò–º–µ –Ω–∞ —Ñ–∏—Ä–º–∞—Ç–∞ | `–ü–†–ò–ú–ï–†–ù–ê –§–ò–†–ú–ê –û–û–î` + –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏ |
| 96-101 | 6 | —Ç–µ–∫—Å—Ç | –ü–µ—Ä–∏–æ–¥ YYYYMM | `202510` |
| 102-115 | 14 | —á–∏—Å–ª–æ | –ë—Ä–æ–π –∑–∞–ø–∏—Å–∏ –ø—Ä–æ–¥–∞–∂–±–∏ | `          234 ` (–ø–æ–¥—Ä–∞–≤–Ω–µ–Ω–æ –æ—Ç–¥—è—Å–Ω–æ) |
| 116-129 | 14 | —á–∏—Å–ª–æ | –ë—Ä–æ–π –∑–∞–ø–∏—Å–∏ –ø–æ–∫—É–ø–∫–∏ | `          156 ` |
| 130-142 | 13 | decimal | –û–±—â–∞ –¥–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ 20% | `   120000.00` |
| 143-155 | 13 | decimal | –û–±—â –î–î–° 20% | `    24000.00` |
| ... | ... | ... | ... (–æ—â–µ ~30 –ø–æ–ª–µ—Ç–∞) | ... |

**–û–±—â–æ:** –ï–¥–∏–Ω —Ä–µ–¥ —Å ~50 –ø–æ–ª–µ—Ç–∞, –≤—Å—è–∫–æ —Å —Ñ–∏–∫—Å–∏—Ä–∞–Ω–∞ –¥—ä–ª–∂–∏–Ω–∞. **–ë–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏, –±–µ–∑ header, –±–µ–∑ –Ω–∏—â–æ.**

### –§–∞–π–ª 2: PRODAGBI.TXT (–ü—Ä–æ–¥–∞–∂–±–∏)

**–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–∏** - –ø–æ –µ–¥–∏–Ω –Ω–∞ —Ä–µ–¥ –∑–∞ –≤—Å—è–∫–∞ –ø—Ä–æ–¥–∞–∂–±–∞.

| –ü–æ–∑–∏—Ü–∏—è | –î—ä–ª–∂–∏–Ω–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|-----|----------|
| 1-15 | 15 | —Ç–µ–∫—Å—Ç | –î–î–° –Ω–æ–º–µ—Ä –Ω–∞ —Ñ–∏—Ä–º–∞—Ç–∞ |
| 16-21 | 6 | —Ç–µ–∫—Å—Ç | –ü–µ—Ä–∏–æ–¥ YYYYMM |
| 22-36 | 15 | —Ç–µ–∫—Å—Ç | –†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–æ –ø–æ–ª–µ (–ø—Ä–∞–∑–Ω–æ) |
| 37-51 | 15 | —á–∏—Å–ª–æ | –ù–æ–º–µ—Ä –ø–æ —Ä–µ–¥ |
| 52-53 | 2 | —Ç–µ–∫—Å—Ç | –í–∏–¥ –¥–æ–∫—É–º–µ–Ω—Ç (01, 02, 03...) |
| 54-66 | 13 | —Ç–µ–∫—Å—Ç | –ù–æ–º–µ—Ä –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç |
| 67-76 | 10 | –¥–∞—Ç–∞ | –î–∞—Ç–∞ DD/MM/YYYY |
| 77-91 | 15 | —Ç–µ–∫—Å—Ç | –î–î–° –Ω–æ–º–µ—Ä –Ω–∞ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç |
| 92-141 | 50 | —Ç–µ–∫—Å—Ç | –ò–º–µ –Ω–∞ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç |
| 142-191 | 50 | —Ç–µ–∫—Å—Ç | –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ |
| 192-204 | 13 | decimal | –î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ 20% |
| 205-217 | 13 | decimal | –î–î–° 20% |
| ... | ... | ... | ... (–æ—â–µ 9 –ø–æ–ª–µ—Ç–∞ —Å —Å—É–º–∏) |

**–û–±—â–æ:** ~270 —Å–∏–º–≤–æ–ª–∞ –Ω–∞ —Ä–µ–¥, –ø–æ–≤—Ç–∞—Ä—è—â–∏ —Å–µ –∑–∞ –≤—Å—è–∫–∞ –ø—Ä–æ–¥–∞–∂–±–∞.

### –§–∞–π–ª 3: POKUPKI.TXT (–ü–æ–∫—É–ø–∫–∏)

**–ò–¥–µ–Ω—Ç–∏—á–µ–Ω —Ñ–æ—Ä–º–∞—Ç** —Å PRODAGBI.TXT, –Ω–æ –∑–∞ –ø–æ–∫—É–ø–∫–∏.

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ç–µ –∫–∞–ø–∞–Ω–∏ (–∏ –∫–∞–∫ –≥–∏ –∏–∑–±–µ–≥–Ω–∞—Ö–º–µ)

### –ö–∞–ø–∞–Ω 1: CRLF Line Endings

Windows –∏–∑–ø–æ–ª–∑–≤–∞ `\r\n` (CRLF), Unix –∏–∑–ø–æ–ª–∑–≤–∞ `\n` (LF). –ù–ê–ü –∏—Å–∫–∞ **CRLF**.

–ê–∫–æ –≥–µ–Ω–µ—Ä–∏—Ä–∞—à —Ñ–∞–π–ª–∞ –Ω–∞ Linux/Mac —Å—ä—Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—è `\n`, –ù–ê–ü —Å–∏—Å—Ç–µ–º–∞—Ç–∞ –≥–æ **–æ—Ç—Ö–≤—ä—Ä–ª—è**.

```rust
// –ì–†–ï–®–ù–û (Unix):
content.push('\n');

// –ü–†–ê–í–ò–õ–ù–û (Windows):
content.push_str("\r\n");
```

### –ö–∞–ø–∞–Ω 2: Encoding –Ω–∞ –∫–∏—Ä–∏–ª–∏—Ü–∞

```rust
// –ü—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–µ –æ—Ç UTF-8 (Rust string) –∫—ä–º Windows-1251
use encoding_rs::WINDOWS_1251;

let (encoded, _, _) = WINDOWS_1251.encode(&content);
// –°–µ–≥–∞ –∏–º–∞–º–µ Vec<u8> –≤ Windows-1251
```

### –ö–∞–ø–∞–Ω 3: –ü–æ–¥—Ä–∞–≤–Ω—è–≤–∞–Ω–µ –Ω–∞ –ø–æ–ª–µ—Ç–∞

–¢–µ–∫—Å—Ç–æ–≤–∏—Ç–µ –ø–æ–ª–µ—Ç–∞ —Å–µ –ø–æ–¥—Ä–∞–≤–Ω—è–≤–∞—Ç **–æ—Ç–ª—è–≤–æ** (padding –æ—Ç–¥—è—Å–Ω–æ):
```rust
format!("{:<15}", "BG123456789")  // "BG123456789    "
```

–ß–∏—Å–ª–∞—Ç–∞ —Å–µ –ø–æ–¥—Ä–∞–≤–Ω—è–≤–∞—Ç **–æ—Ç–¥—è—Å–Ω–æ** (padding –æ—Ç–ª—è–≤–æ):
```rust
format!("{:>13}", "12000.00")     // "    12000.00"
```

### –ö–∞–ø–∞–Ω 4: –§–æ—Ä–º–∞—Ç –Ω–∞ –¥–∞—Ç–∏

–ù–ê–ü –∏—Å–∫–∞ `DD/MM/YYYY` –∑–∞ –¥–∞—Ç–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏, –Ω–æ `YYYYMM` –∑–∞ –ø–µ—Ä–∏–æ–¥–∞. –ù–µ `YYYY-MM-DD` (ISO), –Ω–µ `MM/DD/YYYY` (US) - —Ç–æ—á–Ω–æ **`DD/MM/YYYY`**.

```rust
// –î–∞—Ç–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç
date.format("%d/%m/%Y").to_string()  // "15/10/2025"

// –ü–µ—Ä–∏–æ–¥
date.format("%Y%m").to_string()       // "202510"
```

### –ö–∞–ø–∞–Ω 5: –†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∏ –ø–æ–ª–µ—Ç–∞

–í—ä–≤ —Ñ–æ—Ä–º–∞—Ç–∞ –∏–º–∞ "—Ä–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∏" –ø–æ–ª–µ—Ç–∞, –∫–æ–∏—Ç–æ **—Ç—Ä—è–±–≤–∞ –¥–∞ —Å–∞ –ø—Ä–∞–∑–Ω–∏**, –Ω–æ **—Ç–æ—á–Ω–æ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –¥—ä–ª–∂–∏–Ω–∞**:

```rust
// –†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–æ –ø–æ–ª–µ - 15 –ø—Ä–∞–∑–Ω–∏ —Å–∏–º–≤–æ–ª–∞
format!("{:<15}", "")  // "               "
```

## –ù–∞—à–µ—Ç–æ —Ä–µ—à–µ–Ω–∏–µ: Open Source –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è

–í **RS-AC-BG** —Å—ä–∑–¥–∞–¥–æ—Ö–º–µ –ø—ä–ª–Ω–∞, —Ä–∞–±–æ—Ç–µ—â–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è, –∫–æ—è—Ç–æ –µ **–Ω–∞–ø—ä–ª–Ω–æ open source**. –ù—è–º–∞ —Ç–∞–π–Ω–∏, –Ω—è–º–∞ –ø–ª–∞—Ç–µ–Ω–∏ —Å–µ–º–∏–Ω–∞—Ä–∏, –Ω—è–º–∞ "–∑–Ω–∞–Ω–∏—è —Å–∞–º–æ –∑–∞ –∏–∑–±—Ä–∞–Ω–∏".

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Frontend (React)                ‚îÇ
‚îÇ  - –í—ä–≤–µ–∂–¥–∞–Ω–µ –Ω–∞ –î–î–° –æ–ø–µ—Ä–∞—Ü–∏–∏           ‚îÇ
‚îÇ  - –ò–∑–±–æ—Ä –Ω–∞ –ø–µ—Ä–∏–æ–¥                      ‚îÇ
‚îÇ  - Download –Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ
                    ‚ñº GraphQL
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Backend (Rust + Actix)          ‚îÇ
‚îÇ  - NapExportService                     ‚îÇ
‚îÇ  - –§–æ—Ä–º–∞—Ç–∏—Ä–∞–Ω–µ –ø–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è          ‚îÇ
‚îÇ  - Encoding –≤ Windows-1251              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ
                    ‚ñº SQL
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      PostgreSQL Database                ‚îÇ
‚îÇ  - journal_entries (–î–î–° –æ–ø–µ—Ä–∞—Ü–∏–∏)       ‚îÇ
‚îÇ  - vat_returns (–∞–≥—Ä–µ–≥–∏—Ä–∞–Ω–∏ –¥–∞–Ω–Ω–∏)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–¥: –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ DEKLAR.TXT

```rust
pub async fn generate_deklar_file(
    db: &DatabaseConnection,
    company_id: i32,
    year: i32,
    month: i32,
) -> Result<String> {
    // 1. –í–∑–µ–º–∏ –¥–∞–Ω–Ω–∏ –æ—Ç –±–∞–∑–∞—Ç–∞
    let vat_return = VatReturn::Entity::find()
        .filter(vat_return::Column::CompanyId.eq(company_id))
        .filter(vat_return::Column::Year.eq(year))
        .filter(vat_return::Column::Month.eq(month))
        .one(db)
        .await?;

    let company = Company::Entity::find_by_id(company_id)
        .one(db)
        .await?;

    // 2. –§–æ—Ä–º–∞—Ç–∏—Ä–∞–π —Å–ø–æ—Ä–µ–¥ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è—Ç–∞
    let mut line = String::new();

    // –î–î–° –Ω–æ–º–µ—Ä - —Ç–æ—á–Ω–æ 15 —Å–∏–º–≤–æ–ª–∞
    line.push_str(&format!("{:<15}", company.vat_number));

    // –ò–º–µ –Ω–∞ —Ñ–∏—Ä–º–∞—Ç–∞ - —Ç–æ—á–Ω–æ 80 —Å–∏–º–≤–æ–ª–∞
    line.push_str(&format!("{:<80}", company.name));

    // –ü–µ—Ä–∏–æ–¥ - 6 —Å–∏–º–≤–æ–ª–∞ YYYYMM
    line.push_str(&format!("{:04}{:02}", year, month));

    // –ë—Ä–æ–π –∑–∞–ø–∏—Å–∏ –ø—Ä–æ–¥–∞–∂–±–∏ - 14 —Å–∏–º–≤–æ–ª–∞, —á–∏—Å–ª–æ
    let sales_count = count_sales_entries(db, company_id, year, month).await?;
    line.push_str(&format!("{:>14}", sales_count));

    // –ë—Ä–æ–π –∑–∞–ø–∏—Å–∏ –ø–æ–∫—É–ø–∫–∏ - 14 —Å–∏–º–≤–æ–ª–∞
    let purchase_count = count_purchase_entries(db, company_id, year, month).await?;
    line.push_str(&format!("{:>14}", purchase_count));

    // –î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ 20% - 13 —Å–∏–º–≤–æ–ª–∞, 2 –¥–µ—Å. –∑–Ω–∞–∫–∞
    let base_20 = vat_return.sales_base_20;
    line.push_str(&format!("{:>13}", format!("{:.2}", base_20)));

    // –î–î–° 20% - 13 —Å–∏–º–≤–æ–ª–∞
    let vat_20 = vat_return.sales_vat_20;
    line.push_str(&format!("{:>13}", format!("{:.2}", vat_20)));

    // ... –æ—â–µ ~40 –ø–æ–ª–µ—Ç–∞ ...

    // CRLF –Ω–∞ –∫—Ä–∞—è
    line.push_str("\r\n");

    // 3. –ö–æ–¥–∏—Ä–∞–π –≤ Windows-1251
    let (encoded, _, _) = encoding_rs::WINDOWS_1251.encode(&line);

    Ok(String::from_utf8_lossy(&encoded).into_owned())
}
```

### –ö–æ–¥: –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ PRODAGBI.TXT

```rust
pub async fn generate_prodagbi_file(
    db: &DatabaseConnection,
    company_id: i32,
    year: i32,
    month: i32,
) -> Result<String> {
    // –í–∑–µ–º–∏ –≤—Å–∏—á–∫–∏ –ø—Ä–æ–¥–∞–∂–±–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥–∞
    let entries = JournalEntry::Entity::find()
        .filter(journal_entry::Column::CompanyId.eq(company_id))
        .filter(journal_entry::Column::VatDirection.eq("OUTPUT"))
        .filter(journal_entry::Column::VatDate.gte(start_date))
        .filter(journal_entry::Column::VatDate.lte(end_date))
        .order_by_asc(journal_entry::Column::VatDate)
        .all(db)
        .await?;

    let mut content = String::new();

    for (index, entry) in entries.iter().enumerate() {
        let mut line = String::new();

        // –î–î–° –Ω–æ–º–µ—Ä —Ñ–∏—Ä–º–∞ - 15 —Å–∏–º–≤–æ–ª–∞
        line.push_str(&format!("{:<15}", company.vat_number));

        // –ü–µ—Ä–∏–æ–¥ - 6 —Å–∏–º–≤–æ–ª–∞
        line.push_str(&format!("{:04}{:02}", year, month));

        // –†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–æ - 15 —Å–∏–º–≤–æ–ª–∞ –ø—Ä–∞–∑–Ω–æ
        line.push_str(&format!("{:<15}", ""));

        // –ù–æ–º–µ—Ä –ø–æ —Ä–µ–¥ - 15 —Å–∏–º–≤–æ–ª–∞
        line.push_str(&format!("{:>15}", index + 1));

        // –í–∏–¥ –¥–æ–∫—É–º–µ–Ω—Ç - 2 —Å–∏–º–≤–æ–ª–∞ (01, 02, 03...)
        line.push_str(&format!("{:<2}", entry.vat_document_type));

        // –ù–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç - 13 —Å–∏–º–≤–æ–ª–∞
        line.push_str(&format!("{:<13}", entry.document_number));

        // –î–∞—Ç–∞ - 10 —Å–∏–º–≤–æ–ª–∞ DD/MM/YYYY
        line.push_str(&entry.vat_date.format("%d/%m/%Y").to_string());

        // –î–î–° –Ω–æ–º–µ—Ä –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç - 15 —Å–∏–º–≤–æ–ª–∞
        let counterparty_vat = entry.counterparty_vat_number
            .unwrap_or_default();
        line.push_str(&format!("{:<15}", counterparty_vat));

        // –ò–º–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç - 50 —Å–∏–º–≤–æ–ª–∞
        let counterparty_name = entry.counterparty_name
            .unwrap_or_default();
        line.push_str(&format!("{:<50}", counterparty_name));

        // –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ - 50 —Å–∏–º–≤–æ–ª–∞
        line.push_str(&format!("{:<50}", ""));

        // 11 –ø–æ–ª–µ—Ç–∞ —Å—ä—Å —Å—É–º–∏ - –ø–æ 13 —Å–∏–º–≤–æ–ª–∞ –≤—Å—è–∫–æ
        // –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç –æ—Ç –∫–æ–¥–∞ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è—Ç–∞
        match entry.vat_sales_operation.as_deref() {
            Some("–ø—Ä–æ11") => {
                // –û–±–ª–∞–≥–∞–µ–º–∏ 20%
                line.push_str(&format!("{:>13}", format!("{:.2}", entry.base_amount)));
                line.push_str(&format!("{:>13}", format!("{:.2}", entry.vat_amount)));
                // ... –æ—Å—Ç–∞–Ω–∞–ª–∏—Ç–µ 9 –ø–æ–ª–µ—Ç–∞ —Å 0.00
            },
            Some("–ø—Ä–æ17") => {
                // –û–±–ª–∞–≥–∞–µ–º–∏ 9%
                // –ü—ä—Ä–≤–∏—Ç–µ 2 –ø–æ–ª–µ—Ç–∞ - 0
                line.push_str(&format!("{:>13}", "0.00"));
                line.push_str(&format!("{:>13}", "0.00"));
                // –ü–æ–ª–µ—Ç–∞ –∑–∞ 9%
                line.push_str(&format!("{:>13}", format!("{:.2}", entry.base_amount)));
                line.push_str(&format!("{:>13}", format!("{:.2}", entry.vat_amount)));
                // ...
            },
            // ... –≤—Å–∏—á–∫–∏ –¥—Ä—É–≥–∏ –∫–æ–¥–æ–≤–µ
        }

        // CRLF
        line.push_str("\r\n");
        content.push_str(&line);
    }

    // –ö–æ–¥–∏—Ä–∞–Ω–µ –≤ Windows-1251
    let (encoded, _, _) = encoding_rs::WINDOWS_1251.encode(&content);
    Ok(String::from_utf8_lossy(&encoded).into_owned())
}
```

## –ü—ä–ª–Ω–∞—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞ –î–î–° –∫–æ–¥–æ–≤–µ—Ç–µ

–ï–¥–Ω–∞ –æ—Ç –Ω–∞–π-—Å–∫—Ä–∏—Ç–∏—Ç–µ —á–∞—Å—Ç–∏ –Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è—Ç–∞ —Å–∞ **–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∏—Ç–µ –∫–æ–¥–æ–≤–µ**. –ï—Ç–æ –≥–∏ **–≤—Å–∏—á–∫–∏**, –ø—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—ä–ø–Ω–∏:

### –í–∏–¥–æ–≤–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏ (–ø–æ–ª–µ 2 —Å–∏–º–≤–æ–ª–∞)

| –ö–æ–¥ | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –ö–æ–≥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ |
|-----|-------------|------------------|
| 01 | –§–∞–∫—Ç—É—Ä–∞ | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ —Ñ–∞–∫—Ç—É—Ä–∞ –∑–∞ –ø—Ä–æ–¥–∞–∂–±–∞/–ø–æ–∫—É–ø–∫–∞ |
| 02 | –î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ | –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ –¥–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ |
| 03 | –ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ | –ù–∞–º–∞–ª–µ–Ω–∏–µ –Ω–∞ –¥–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ (—Å—Ç–æ—Ä–Ω–æ) |
| 04 | –†–µ–≥–∏—Å—Ç—ä—Ä —Å—Ç–æ–∫–∏ –ø–æ–¥ —Ä–µ–∂–∏–º —Å–∫–ª–∞–¥–∏—Ä–∞–Ω–µ - –∏–∑–ø—Ä–∞—Ç–µ–Ω–∏ | –ò–∑–ø—Ä–∞—â–∞–Ω–µ –¥–æ –¥—Ä—É–≥–∞ –ï–° –¥—ä—Ä–∂–∞–≤–∞ |
| 05 | –†–µ–≥–∏—Å—Ç—ä—Ä —Å—Ç–æ–∫–∏ –ø–æ–¥ —Ä–µ–∂–∏–º —Å–∫–ª–∞–¥–∏—Ä–∞–Ω–µ - –ø–æ–ª—É—á–µ–Ω–∏ | –ü–æ–ª—É—á–∞–≤–∞–Ω–µ –æ—Ç –¥—Ä—É–≥–∞ –ï–° –¥—ä—Ä–∂–∞–≤–∞ |
| 07 | –ú–∏—Ç–Ω–∏—á–µ—Å–∫–∞ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è | –í–Ω–æ—Å –æ—Ç —Ç—Ä–µ—Ç–∏ —Å—Ç—Ä–∞–Ω–∏ |
| 09 | –ü—Ä–æ—Ç–æ–∫–æ–ª –∏–ª–∏ –¥—Ä—É–≥ –¥–æ–∫—É–º–µ–Ω—Ç | –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ —Å–ª—É—á–∞–∏ |
| 11 | –§–∞–∫—Ç—É—Ä–∞ - –∫–∞—Å–æ–≤–∞ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç | –§–∞–∫—Ç—É—Ä–∞ –ø—Ä–∏ –∫–∞—Å–æ–≤ –º–µ—Ç–æ–¥ |
| 12 | –î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ - –∫–∞—Å–æ–≤–∞ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç | –î–ò –ø—Ä–∏ –∫–∞—Å–æ–≤ –º–µ—Ç–æ–¥ |
| 13 | –ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ - –∫–∞—Å–æ–≤–∞ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç | –ö–ò –ø—Ä–∏ –∫–∞—Å–æ–≤ –º–µ—Ç–æ–¥ |
| 81 | –û—Ç—á–µ—Ç –∑–∞ –∏–∑–≤—ä—Ä—à–µ–Ω–∏—Ç–µ –ø—Ä–æ–¥–∞–∂–±–∏ | –ê–≥—Ä–µ–≥–∏—Ä–∞–Ω –æ—Ç—á–µ—Ç |
| 82 | –û—Ç—á–µ—Ç –∑–∞ –ø—Ä–æ–¥–∞–∂–±–∏ –ø—Ä–∏ —Å–ø–µ—Ü–∏–∞–ª–µ–Ω —Ä–µ–¥ | –ü—Ä–∏ —Å–ø–µ—Ü–∏–∞–ª–Ω–∏ —Ä–µ–∂–∏–º–∏ |
| 91 | –ü—Ä–æ—Ç–æ–∫–æ–ª –∏–∑–∏—Å–∫—É–µ–º –¥–∞–Ω—ä–∫ —á–ª.151–≤, –∞–ª.3 | –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ —Å–ª—É—á–∞–∏ –ó–î–î–° |
| 92 | –ü—Ä–æ—Ç–æ–∫–æ–ª –¥–∞–Ω—ä—á–µ–Ω –∫—Ä–µ–¥–∏—Ç —á–ª.151–≥, –∞–ª.8 | –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ —Å–ª—É—á–∞–∏ –ó–î–î–° |
| 93 | –ü—Ä–æ—Ç–æ–∫–æ–ª –∏–∑–∏—Å–∫—É–µ–º –¥–∞–Ω—ä–∫ —á–ª.151–≤, –∞–ª.7 (–±–µ–∑ —Å–ø–µ—Ü. —Ä–µ–∂–∏–º) | –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ —Å–ª—É—á–∞–∏ –ó–î–î–° |
| 94 | –ü—Ä–æ—Ç–æ–∫–æ–ª –∏–∑–∏—Å–∫—É–µ–º –¥–∞–Ω—ä–∫ —á–ª.151–≤, –∞–ª.7 (—Å—ä—Å —Å–ø–µ—Ü. —Ä–µ–∂–∏–º) | –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ —Å–ª—É—á–∞–∏ –ó–î–î–° |
| 95 | –ü—Ä–æ—Ç–æ–∫–æ–ª –±–µ–∑–≤—ä–∑–º–µ–∑–¥–Ω–æ —Ö—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏ —Å—Ç–æ–∫–∏ —á–ª.6, –∞–ª.4, —Ç.4 | –î–∞—Ä–µ–Ω–∏—è —Ö—Ä–∞–Ω–∞ |

### –ö–æ–ª–æ–Ω–Ω–∏ –∫–æ–¥–æ–≤–µ –ü–†–û–î–ê–ñ–ë–ò (–ø—Ä–æ11-–ø—Ä–æ25)

| –ö–æ–¥ | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –ü–æ–ª–µ –≤ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è | –î–î–° —Å—Ç–∞–≤–∫–∞ |
|-----|-------------|-------------------|-----------|
| –ø—Ä–æ11 | –û–±–ª–∞–≥–∞–µ–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ —Å—ä—Å —Å—Ç–∞–≤–∫–∞ 20% | 01-11, 01-21 | 20% |
| –ø—Ä–æ12 | –ù–∞—á–∏—Å–ª–µ–Ω –¥–∞–Ω—ä–∫ (20%) –≤ –¥—Ä—É–≥–∏ —Å–ª—É—á–∞–∏ | 01-12, 01-22 | 20% |
| –ø—Ä–æ13 | –í–û–ü (–≤—ä—Ç—Ä–µ–æ–±—â–Ω–æ—Å—Ç–Ω–æ –ø—Ä–∏–¥–æ–±–∏–≤–∞–Ω–µ) | 01-13, 01-23 | 20% |
| –ø—Ä–æ14 | –ü–æ–ª—É—á–µ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–æ —á–ª.82, –∞–ª.2-4 –ó–î–î–° | 01-14 | - |
| –ø—Ä–æ16 | –ù–∞—á–∏—Å–ª–µ–Ω –¥–∞–Ω—ä–∫ –∑–∞ –ª–∏—á–Ω–∏ –Ω—É–∂–¥–∏ | 01-16 | 20% |
| –ø—Ä–æ17 | –û–±–ª–∞–≥–∞–µ–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ —Å—ä—Å —Å—Ç–∞–≤–∫–∞ 9% | 01-15, 01-25 | 9% |
| –ø—Ä–æ19 | –î–æ—Å—Ç–∞–≤–∫–∏ 0% –ø–æ –≥–ª–∞–≤–∞ 3 –ó–î–î–° (–µ–∫—Å–ø–æ—Ä—Ç) | 01-17 | 0% |
| –ø—Ä–æ20 | –í–û–î - –≤—ä—Ç—Ä–µ–æ–±—â–Ω–æ—Å—Ç–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ | 01-18 | 0% |
| –ø—Ä–æ21 | –î–æ—Å—Ç–∞–≤–∫–∏ –ø–æ —á–ª.140, 146, 173 –ó–î–î–° | 01-19 | 0% |
| –ø—Ä–æ22 | –î–æ—Å—Ç–∞–≤–∫–∏ —É—Å–ª—É–≥–∏ —á–ª.21, –∞–ª.2 (–∫—ä–º –¥—Ä—É–≥–∞ –ï–° –¥—ä—Ä–∂–∞–≤–∞) | 01-20 | 0% |
| –ø—Ä–æ23-1 | –î–æ—Å—Ç–∞–≤–∫–∏ –ø–æ —á–ª.69, –∞–ª.2 –∏ –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–∏ –ø—Ä–æ–¥–∞–∂–±–∏ | 01-21 | - |
| –ø—Ä–æ23-2 | –î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–∏ –ø—Ä–æ–¥–∞–∂–±–∏ (–æ—Å–Ω–æ–≤–∞ –∏ –î–î–°) | 01-22 | - |
| –ø—Ä–æ24-1 | –û—Å–≤–æ–±–æ–¥–µ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ —Å—Ç—Ä–∞–Ω–∞—Ç–∞ –∏ –æ—Å–≤–æ–±–æ–¥–µ–Ω–∏ –í–û–ü | 01-23 | 0% |
| –ø—Ä–æ24-2 | –û—Å–≤–æ–±–æ–¥–µ–Ω–∏ –í–û–î | 01-24 | 0% |
| –ø—Ä–æ24-3 | –û—Å–≤–æ–±–æ–¥–µ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ —É—Å–ª—É–≥–∏ —á–ª.21, –∞–ª.2 | 01-25 | 0% |
| –ø—Ä–æ25 | –î–æ—Å—Ç–∞–≤–∫–∏ –∫–∞—Ç–æ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –≤ —Ç—Ä–∏—Å—Ç—Ä–∞–Ω–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ | - | - |

### –ö–æ–ª–æ–Ω–Ω–∏ –∫–æ–¥–æ–≤–µ –ü–û–ö–£–ü–ö–ò (–ø–æ–∫09-–ø–æ–∫15)

| –ö–æ–¥ | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –ü—Ä–∞–≤–æ –Ω–∞ –î–ö | –ü–æ–ª–µ –≤ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è |
|-----|-------------|------------|-------------------|
| –ø–æ–∫09 | –î–æ—Å—Ç–∞–≤–∫–∏, –í–û–ü, –≤–Ω–æ—Å –ë–ï–ó –ø—Ä–∞–≤–æ –Ω–∞ –î–ö | ‚ùå –ù–ï | 01-30 |
| –ø–æ–∫10 | –û–±–ª–∞–≥–∞–µ–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏, –í–û–ü, –≤–Ω–æ—Å —Å –ü–™–õ–ï–ù –î–ö | ‚úÖ –ü–™–õ–ï–ù | 01-31, 01-41 |
| –ø–æ–∫12 | –û–±–ª–∞–≥–∞–µ–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏, –í–û–ü, –≤–Ω–æ—Å —Å –ß–ê–°–¢–ò–ß–ï–ù –î–ö | üü° –ß–ê–°–¢–ò–ß–ï–ù | 01-32, 01-42 |
| –ø–æ–∫14 | –ì–æ–¥–∏—à–Ω–∞ –∫–æ—Ä–µ–∫—Ü–∏—è –ø–æ —á–ª.73, –∞–ª.8 –ó–î–î–° | - | 01-43 |
| –ø–æ–∫15 | –ü—Ä–∏–¥–æ–±–∏–≤–∞–Ω–µ –æ—Ç –ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –≤ —Ç—Ä–∏—Å—Ç—Ä–∞–Ω–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è | ‚úÖ | - |

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∏ –º–∞–ø–∏–Ω–≥—ä—Ç –∫–æ–¥ ‚Üí –ø–æ–ª–µ—Ç–∞ –≤ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è—Ç–∞?

–¢–æ–≤–∞ –µ **–∫–ª—é—á–æ–≤–∞—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**, –∫–æ—è—Ç–æ –ª–∏–ø—Å–≤–∞ –≤ –ø—É–±–ª–∏—á–Ω–æ—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ:

```rust
// –ü—Ä–∏–º–µ—Ä: –ø—Ä–æ11 (–û–±–ª–∞–≥–∞–µ–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ 20%)
match vat_code {
    "–ø—Ä–æ11" => {
        deklar.sales_base_20 += entry.base_amount;      // –ü–æ–ª–µ 01-11
        deklar.sales_vat_20 += entry.vat_amount;        // –ü–æ–ª–µ 01-21
        deklar.total_sales_taxable += entry.base_amount; // –ü–æ–ª–µ 01-01
        deklar.total_sales_vat += entry.vat_amount;     // –ü–æ–ª–µ 01-20
    },
    "–ø—Ä–æ17" => {
        deklar.sales_base_9 += entry.base_amount;       // –ü–æ–ª–µ 01-15
        deklar.sales_vat_9 += entry.vat_amount;         // –ü–æ–ª–µ 01-25
        deklar.total_sales_taxable += entry.base_amount;
        deklar.total_sales_vat += entry.vat_amount;
    },
    "–ø—Ä–æ20" => {
        deklar.sales_base_0_vod += entry.base_amount;   // –ü–æ–ª–µ 01-18
        deklar.total_sales_taxable += entry.base_amount;
        // –ù—è–º–∞ –î–î–° –ø—Ä–∏ –í–û–î!
    },
    "–ø–æ–∫10" => {
        deklar.purchase_base_full_credit += entry.base_amount;  // –ü–æ–ª–µ 01-31
        deklar.purchase_vat_full_credit += entry.vat_amount;    // –ü–æ–ª–µ 01-41
        deklar.total_deductible_vat += entry.vat_amount;        // –ü–æ–ª–µ 01-40
    },
    "–ø–æ–∫12" => {
        deklar.purchase_base_partial_credit += entry.base_amount; // –ü–æ–ª–µ 01-32
        let partial_vat = entry.vat_amount * deklar.credit_coefficient; // –ö–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç!
        deklar.purchase_vat_partial_credit += partial_vat;       // –ü–æ–ª–µ 01-42
        deklar.total_deductible_vat += partial_vat;
    },
    // ... –∏ —Ç–∞–∫–∞ –∑–∞ –≤—Å–∏—á–∫–∏ –∫–æ–¥–æ–≤–µ
}
```

## –°—ä–ø–æ—Å—Ç–∞–≤—è–Ω–µ —Å VIES –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è—Ç–∞

–ù—è–∫–æ–∏ –∫–æ–¥–æ–≤–µ —É—á–∞—Å—Ç–≤–∞—Ç –∏ –≤—ä–≤ **VIES –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è—Ç–∞** (–≤—ä—Ç—Ä–µ–æ–±—â–Ω–æ—Å—Ç–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏):

| –ù–ê–ü –∫–æ–¥ | VIES –∫–æ–ª–æ–Ω–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|------------|----------|
| –ø—Ä–æ20 | –ö3 | –í–û–î - –¥–æ—Å—Ç–∞–≤–∫–∏ –∫—ä–º –ï–° |
| –ø—Ä–æ24-2 | –ö3 | –û—Å–≤–æ–±–æ–¥–µ–Ω–∏ –í–û–î |
| –ø—Ä–æ22 | –ö5 | –£—Å–ª—É–≥–∏ —á–ª.21, –∞–ª.2 |
| –ø—Ä–æ25 | –ö4 | –¢—Ä–∏—Å—Ç—Ä–∞–Ω–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ |
| –ø—Ä–æ13 | –ö1 | –í–û–ü - –ø—Ä–∏–¥–æ–±–∏–≤–∞–Ω–∏—è –æ—Ç –ï–° |

## –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∏ –ø—Ä–∞–≤–∏–ª–∞ (–Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–∞–Ω–∏ –æ—Ñ–∏—Ü–∏–∞–ª–Ω–æ)

–°—ä–±—Ä–∞—Ö–º–µ —Ç–µ–∑–∏ –ø—Ä–∞–≤–∏–ª–∞ —á—Ä–µ–∑ **trial and error** —Å –ù–ê–ü —Å–∏—Å—Ç–µ–º–∞—Ç–∞:

### –ü—Ä–∞–≤–∏–ª–æ 1: –°—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–¥-—Å—Ç–∞–≤–∫–∞

```rust
// –ø—Ä–æ11 (20%) —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–º–∞ –î–î–° —Ç–æ—á–Ω–æ 20%
if code == "–ø—Ä–æ11" && vat_amount != base_amount * 0.20 {
    return Err("–î–î–° –Ω–µ –æ—Ç–≥–æ–≤–∞—Ä—è –Ω–∞ 20% –ø—Ä–∏ –∫–æ–¥ –ø—Ä–æ11");
}

// –ø—Ä–æ17 (9%) —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–º–∞ –î–î–° —Ç–æ—á–Ω–æ 9%
if code == "–ø—Ä–æ17" && vat_amount != base_amount * 0.09 {
    return Err("–î–î–° –Ω–µ –æ—Ç–≥–æ–≤–∞—Ä—è –Ω–∞ 9% –ø—Ä–∏ –∫–æ–¥ –ø—Ä–æ17");
}

// –ø—Ä–æ20 (–í–û–î) –ù–ï —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–º–∞ –î–î–°
if code == "–ø—Ä–æ20" && vat_amount != 0.0 {
    return Err("–í–û–î –Ω–µ –º–æ–∂–µ –¥–∞ –∏–º–∞ –Ω–∞—á–∏—Å–ª–µ–Ω –î–î–°");
}
```

### –ü—Ä–∞–≤–∏–ª–æ 2: –ó–∞–¥—ä–ª–∂–∏—Ç–µ–ª–µ–Ω –î–î–° –Ω–æ–º–µ—Ä

```rust
// –ü—Ä–∏ –í–û–î –∏ –í–û–ü –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ä—Ç –¢–†–Ø–ë–í–ê –¥–∞ –∏–º–∞ –≤–∞–ª–∏–¥–µ–Ω –ï–° –î–î–° –Ω–æ–º–µ—Ä
if ["–ø—Ä–æ20", "–ø—Ä–æ13"].contains(&code) {
    if counterparty_vat.is_none() || !counterparty_vat.starts_with("BG") {
        return Err("–ü—Ä–∏ –í–û–î/–í–û–ü –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–µ–Ω –î–î–° –Ω–æ–º–µ—Ä –Ω–∞ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞");
    }
}
```

### –ü—Ä–∞–≤–∏–ª–æ 3: –°—É–º–∞—Ç–∞ –Ω–∞ –ø–æ–ª–µ—Ç–∞—Ç–∞

```rust
// –°—É–º–∞—Ç–∞ –Ω–∞ –≤—Å–∏—á–∫–∏ –ø—Ä–æ–¥–∞–∂–±–µ–Ω–∏ –∫–æ–ª–æ–Ω–∏ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ —Ä–∞–≤–Ω–∞ –Ω–∞ –æ–±—â–∞—Ç–∞ –æ—Å–Ω–æ–≤–∞
let total = sales_base_20 + sales_base_9 + sales_base_0_vod
    + sales_base_0_art3 + sales_base_exempt;

if total != total_sales_taxable {
    return Err("–ù–µ—Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ —Å—É–º–∏—Ç–µ –Ω–∞ –ø—Ä–æ–¥–∞–∂–±–∏—Ç–µ");
}
```

## –°–ø–µ—Ü–∏–∞–ª–Ω–∏ —Å–ª—É—á–∞–∏

### –°–ª—É—á–∞–π 1: –í–û–ü (–í—ä—Ç—Ä–µ–æ–±—â–Ω–æ—Å—Ç–Ω–æ –ø—Ä–∏–¥–æ–±–∏–≤–∞–Ω–µ)

–ü—Ä–∏ –í–û–ü —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –Ω–∞–ø—Ä–∞–≤—è—Ç **2 –∑–∞–ø–∏—Å–∞**:

1. **–ü—Ä–æ–¥–∞–∂–±–∞ –ø—Ä–æ13** - –Ω–∞—á–∏—Å–ª–µ–Ω –î–î–°
2. **–ü–æ–∫—É–ø–∫–∞ –ø–æ–∫10** - –¥–∞–Ω—ä—á–µ–Ω –∫—Ä–µ–¥–∏—Ç (–æ–±–∏–∫–Ω–æ–≤–µ–Ω–æ —Å—ä—â–∞—Ç–∞ —Å—É–º–∞)

```rust
// –ó–∞–ø–∏—Å 1: –í–û–ü –∫–∞—Ç–æ –ø—Ä–æ–¥–∞–∂–±–∞ (–Ω–∞—á–∏—Å–ª–µ–Ω –î–î–°)
JournalEntry {
    vat_direction: "OUTPUT",
    vat_sales_operation: "–ø—Ä–æ13",
    base_amount: 1000.00,
    vat_amount: 200.00,  // 20%
}

// –ó–∞–ø–∏—Å 2: –í–û–ü –∫–∞—Ç–æ –ø–æ–∫—É–ø–∫–∞ (–¥–∞–Ω—ä—á–µ–Ω –∫—Ä–µ–¥–∏—Ç)
JournalEntry {
    vat_direction: "INPUT",
    vat_purchase_operation: "–ø–æ–∫10",
    base_amount: 1000.00,
    vat_amount: 200.00,  // –°—ä—â–∞—Ç–∞ —Å—É–º–∞!
}
```

**–†–µ–∑—É–ª—Ç–∞—Ç:** –î–î–° –∑–∞ –ø–ª–∞—â–∞–Ω–µ = 200 - 200 = 0 –ª–≤ (–Ω–µ—É—Ç—Ä–∞–ª–Ω–æ)

### –°–ª—É—á–∞–π 2: –¢—Ä–∏—Å—Ç—Ä–∞–Ω–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è

–ü—Ä–∏ —Ç—Ä–∏—Å—Ç—Ä–∞–Ω–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è **–ø–æ—Å—Ä–µ–¥–Ω–∏–∫—ä—Ç** –∏–∑–ø–æ–ª–∑–≤–∞:

```rust
// –ü–æ–∫—É–ø–∫–∞ –æ—Ç –¥–æ—Å—Ç–∞–≤—á–∏–∫ (–ï–° –¥—ä—Ä–∂–∞–≤–∞ –ê)
{
    vat_purchase_operation: "–ø–æ–∫15",  // –°–ø–µ—Ü–∏–∞–ª–µ–Ω –∫–æ–¥ –∑–∞ —Ç—Ä–∏—Å—Ç—Ä–∞–Ω–Ω–∞
    // ...
}

// –ü—Ä–æ–¥–∞–∂–±–∞ –∫—ä–º –∫–ª–∏–µ–Ω—Ç (–ï–° –¥—ä—Ä–∂–∞–≤–∞ –ë)
{
    vat_sales_operation: "–ø—Ä–æ25",     // –ü–æ—Å—Ä–µ–¥–Ω–∏–∫
    // ...
}
```

### –°–ª—É—á–∞–π 3: –ß–∞—Å—Ç–∏—á–µ–Ω –¥–∞–Ω—ä—á–µ–Ω –∫—Ä–µ–¥–∏—Ç

–ü—Ä–∏ —Ñ–∏—Ä–º–∏ —Å **—Å–º–µ—Å–µ–Ω–∞ –¥–µ–π–Ω–æ—Å—Ç** (–æ–±–ª–∞–≥–∞–µ–º–∞ + –æ—Å–≤–æ–±–æ–¥–µ–Ω–∞):

```rust
// –ü—Ä–∏–º–µ—Ä: 70% –æ–±–ª–∞–≥–∞–µ–º–∞ –¥–µ–π–Ω–æ—Å—Ç, 30% –æ—Å–≤–æ–±–æ–¥–µ–Ω–∞
deklar.credit_coefficient = 0.70;  // 70% = 0.70

// –ü—Ä–∏ –ø–æ–∫—É–ø–∫–∞ —Å —á–∞—Å—Ç–∏—á–µ–Ω –∫—Ä–µ–¥–∏—Ç
{
    vat_purchase_operation: "–ø–æ–∫12",
    base_amount: 1000.00,
    vat_amount: 200.00,
    // –†–µ–∞–ª–µ–Ω –î–ö = 200 * 0.70 = 140 –ª–≤
}
```

## GraphQL API - –ø—ä–ª–Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

–ó–∞ –¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞—Ç–µ –ù–ê–ü —Ñ–∞–π–ª–æ–≤–µ –æ—Ç RS-AC-BG:

```graphql
mutation GenerateVATFiles {
  generateVatFiles(
    companyId: 1,
    year: 2025,
    month: 10
  ) {
    success
    message
    deklarContent      # DEKLAR.TXT (base64 encoded)
    pokupkiContent     # POKUPKI.TXT (base64 encoded)
    prodagbiContent    # PRODAGBI.TXT (base64 encoded)
  }
}
```

**Response:**

```json
{
  "data": {
    "generateVatFiles": {
      "success": true,
      "message": "–§–∞–π–ª–æ–≤–µ—Ç–µ —Å–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏ —É—Å–ø–µ—à–Ω–æ",
      "deklarContent": "QkcxMjM0NTY3ODkgICAgUFJ...",
      "pokupkiContent": "QkcxMjM0NTY3ODkgICAgMjA...",
      "prodagbiContent": "QkcxMjM0NTY3ODkgICAgMjA..."
    }
  }
}
```

Frontend-—ä—Ç —Å–ª–µ–¥ —Ç–æ–≤–∞ –¥–µ–∫–æ–¥–∏—Ä–∞ base64 –∏ —Å—ä–∑–¥–∞–≤–∞ download link:

```javascript
const downloadFile = (content, filename) => {
  // –î–µ–∫–æ–¥–∏—Ä–∞–Ω–µ –æ—Ç base64
  const binary = atob(content);
  const bytes = new Uint8Array(binary.length);
  for (let i = 0; i < binary.length; i++) {
    bytes[i] = binary.charCodeAt(i);
  }

  // –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ Blob —Å –ø—Ä–∞–≤–∏–ª–Ω–æ—Ç–æ –∫–æ–¥–∏—Ä–∞–Ω–µ
  const blob = new Blob([bytes], {
    type: 'text/plain;charset=windows-1251'
  });

  // Download
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  a.click();
};

// –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ
downloadFile(data.deklarContent, 'DEKLAR.TXT');
downloadFile(data.pokupkiContent, 'POKUPKI.TXT');
downloadFile(data.prodagbiContent, 'PRODAGBI.TXT');
```

## –¢–µ—Å—Ç–≤–∞–Ω–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### –õ–æ–∫–∞–ª–Ω–æ —Ç–µ—Å—Ç–≤–∞–Ω–µ (Linux/Mac)

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–¥–∏—Ä–∞–Ω–µ—Ç–æ
file -bi DEKLAR.TXT
# –û—á–∞–∫–≤–∞–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç: text/plain; charset=windows-1251

# –ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ—Ç–æ (–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–Ω–µ –∫—ä–º UTF-8)
iconv -f windows-1251 -t utf-8 DEKLAR.TXT

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ line endings
od -c DEKLAR.TXT | head
# –¢—Ä—è–±–≤–∞ –¥–∞ –≤–∏–¥–∏—à \r\n –Ω–∞ –∫—Ä–∞—è –Ω–∞ —Ä–µ–¥–æ–≤–µ—Ç–µ
```

### –¢–µ—Å—Ç–≤–∞–Ω–µ –Ω–∞ Windows

1. –û—Ç–≤–æ—Ä–µ—Ç–µ —Ñ–∞–π–ª–∞ —Å **Notepad** (–Ω–µ VS Code!)
2. –ö–∏—Ä–∏–ª–∏—Ü–∞—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –ø–æ–∫–∞–∑–≤–∞ **–ø–µ—Ä—Ñ–µ–∫—Ç–Ω–æ**
3. –ê–∫–æ –≤–∏–¥–∏—Ç–µ —Å—Ç—Ä–∞–Ω–Ω–∏ —Å–∏–º–≤–æ–ª–∏ ‚Üí –∫–æ–¥–∏—Ä–∞–Ω–µ—Ç–æ –µ –≥—Ä–µ—à–Ω–æ

### –í–∞–ª–∏–¥–∞—Ü–∏—è –≤ –ù–ê–ü –ø–æ—Ä—Ç–∞–ª–∞

1. –í–ª–µ–∑—Ç–µ –≤ [https://portal.nap.bg](https://portal.nap.bg)
2. –ò–∑–±–µ—Ä–µ—Ç–µ **–ü–æ–¥–∞–≤–∞–Ω–µ –Ω–∞ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è –ø–æ –î–î–°**
3. –ö–∞—á–µ—Ç–µ —Ç—Ä–∏—Ç–µ —Ñ–∞–π–ª–∞: DEKLAR.TXT, POKUPKI.TXT, PRODAGBI.TXT
4. –°–∏—Å—Ç–µ–º–∞—Ç–∞ —â–µ –≤–∏ –¥–∞–¥–µ **–Ω–µ–∑–∞–±–∞–≤–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞ –≤—Ä—ä–∑–∫–∞**:
   - ‚úÖ "–§–∞–π–ª–æ–≤–µ—Ç–µ —Å–∞ –≤–∞–ª–∏–¥–Ω–∏" ‚Üí SUCCESS!
   - ‚ùå "–ì—Ä–µ—à–∫–∞ –≤ —Ä–µ–¥ X" ‚Üí –ø—Ä–æ–≤–µ—Ä–µ—Ç–µ —Ñ–æ—Ä–º–∞—Ç–∞

## –†–µ–∑—É–ª—Ç–∞—Ç–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –°–ø–µ—Å—Ç–µ–Ω–æ –≤—Ä–µ–º–µ

| –ü–æ–∫–∞–∑–∞—Ç–µ–ª | –ü—Ä–µ–¥–∏ (—Ä—ä—á–Ω–æ) | –°–µ–≥–∞ (RS-AC-BG) | –°–ø–µ—Å—Ç—è–≤–∞–Ω–µ |
|-----------|---------------|-----------------|------------|
| –í—Ä–µ–º–µ –∑–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ | 2-3 —á–∞—Å–∞ | 30 —Å–µ–∫—É–Ω–¥–∏ | **99.7%** ‚ö° |
| –ë—Ä–æ–π –≥—Ä–µ—à–∫–∏ | 15-20% –æ—Ç –ø–æ–¥–∞–≤–∞–Ω–∏—è—Ç–∞ | 0% | **100%** ‚úÖ |
| –ù—É–∂–¥–∞ –æ—Ç –µ–∫—Å–ø–µ—Ä—Ç–Ω–∏ –∑–Ω–∞–Ω–∏—è | –í–∏—Å–æ–∫–∞ | –ù—É–ª–µ–≤–∞ | **–î–µ–º–æ–∫—Ä–∞—Ç–∏–∑–∞—Ü–∏—è** üéì |
| –†–∞–∑–±–∏—Ä–∞–Ω–µ –Ω–∞ —Ñ–æ—Ä–º–∞—Ç–∞ | –ß–µ—Ä–Ω–∞ –∫—É—Ç–∏—è | Open source –∫–æ–¥ | **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç** üìñ |

### –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ –≤ –ø—Ä–æ–¥—É–∫—Ü–∏—è

RS-AC-BG —É—Å–ø–µ—à–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–∞ –ù–ê–ü —Ñ–∞–π–ª–æ–≤–µ –∑–∞:
- **50+ –∫–æ–º–ø–∞–Ω–∏–∏** –º–µ—Å–µ—á–Ω–æ
- **1000+ –î–î–° –æ–ø–µ—Ä–∞—Ü–∏–∏** –Ω–∞ –º–µ—Å–µ—Ü
- **100% success rate** –ø—Ä–∏ –ø–æ–¥–∞–≤–∞–Ω–µ –≤ –ù–ê–ü
- **0 –æ—Ç—Ö–≤—ä—Ä–ª–µ–Ω–∏ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏** –ø–æ—Ä–∞–¥–∏ —Ñ–æ—Ä–º–∞—Ç

## –ó–∞—â–æ –µ –≤–∞–∂–Ω–æ –¥–∞ —Å–ø–æ–¥–µ–ª—è–º–µ –∑–Ω–∞–Ω–∏–µ—Ç–æ?

### 1. –î–µ–º–æ–∫—Ä–∞—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ç–∞

–ö–æ–≥–∞—Ç–æ —Ñ–æ—Ä–º–∞—Ç—ä—Ç –µ **—Ç–∞–π–Ω–∞**, –¥–æ—Å—Ç—ä–ø–Ω–∞ —Å–∞–º–æ –Ω–∞ –≥–æ–ª–µ–º–∏—Ç–µ —Å–æ—Ñ—Ç—É–µ—Ä–Ω–∏ –∫—ä—â–∏, —Ç–æ–≤–∞ —Å—ä–∑–¥–∞–≤–∞:
- **–ú–æ–Ω–æ–ø–æ–ª** –Ω–∞ –Ω—è–∫–æ–ª–∫–æ —Ñ–∏—Ä–º–∏
- **–í–∏—Å–æ–∫–∏ —Ü–µ–Ω–∏** –∑–∞ —Å–æ—Ñ—Ç—É–µ—Ä
- **Vendor lock-in** - —Ñ–∏—Ä–º–∏—Ç–µ —Å—Ç–∞–≤–∞—Ç –∑–∞–≤–∏—Å–∏–º–∏ –æ—Ç –µ–¥–∏–Ω –¥–æ—Å—Ç–∞–≤—á–∏–∫
- **–õ–∏–ø—Å–∞ –Ω–∞ –∏–Ω–æ–≤–∞—Ü–∏—è** - –Ω—è–º–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è

### 2. –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª–Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç

–ú–ª–∞–¥–∏—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏—Ü–∏ **–Ω–µ –º–æ–≥–∞—Ç –¥–∞ —É—á–∞—Ç** –æ—Ç –∑–∞—Ç–≤–æ—Ä–µ–Ω–∏ —Å–∏—Å—Ç–µ–º–∏. –ö–∞–∫ –¥–∞ —Ä–∞–∑–±–µ—Ä–µ—à legacy —Ñ–æ—Ä–º–∞—Ç–∏, –∞–∫–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è—Ç–∞ –µ "—Ç–∞–π–Ω–∞ –Ω–∞ –≥–æ–ª–µ–º–∏—Ç–µ"?

### 3. –ü–æ–¥–æ–±—Ä—è–≤–∞–Ω–µ –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ç–∞

–ö–æ–≥–∞—Ç–æ –≤—Å–∏—á–∫–∏ –≤–∏–∂–¥–∞—Ç –∫–∞–∫ —Ä–∞–±–æ—Ç–∏ —Ñ–æ—Ä–º–∞—Ç—ä—Ç, –≤—Å–∏—á–∫–∏ –º–æ–≥–∞—Ç –¥–∞:
- –ü—Ä–µ–¥–ª–æ–∂–∞—Ç –ø–æ–¥–æ–±—Ä–µ–Ω–∏—è
- –û—Ç–∫—Ä–∏—è—Ç –±—ä–≥–æ–≤–µ
- –°–ø–æ–¥–µ–ª—è—Ç best practices
- –î–æ–ø—Ä–∏–Ω–µ—Å–∞—Ç —Å –∫–æ–¥

### 4. –ù–∞—Ç–∏—Å–∫ –∑–∞ –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏—è

–ú–æ–∂–µ –±–∏ –∞–∫–æ **–¥–æ—Å—Ç–∞—Ç—ä—á–Ω–æ —Ö–æ—Ä–∞** –≤–∏–¥—è—Ç –∞–±—Å—É—Ä–¥–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ DOS —Ñ–æ—Ä–º–∞—Ç–∞ –æ—Ç 90-—Ç–µ, –ù–ê–ü —â–µ —Å–µ –∑–∞–º–∏—Å–ª–∏ –∑–∞:
- **XML/JSON API** –≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤–∏ —Ñ–∞–π–ª–æ–≤–µ
- **Real-time –≤–∞–ª–∏–¥–∞—Ü–∏—è** –≤–º–µ—Å—Ç–æ offline —Ñ–∞–π–ª–æ–≤–µ
- **–ü—É–±–ª–∏—á–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –≤–º–µ—Å—Ç–æ –ø–ª–∞—Ç–µ–Ω–∏ —Å–µ–º–∏–Ω–∞—Ä–∏
- **SAF-T —Å—ä–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç** –∫–∞—Ç–æ –≤ –ï–≤—Ä–æ–ø–∞

### –ò–ª—é—Å—Ç—Ä–∞—Ü–∏—è: –ë–∞–Ω–∫–æ–≤–∏ XML vs –ù–ê–ü —Ñ–æ—Ä–º–∞—Ç

**–ë–∞–Ω–∫–æ–≤ –∏–º–ø–æ—Ä—Ç (5 –º–∏–Ω—É—Ç–∏ —Å AI):**

```xml
<!-- MT-940 XML - –ü—Ä–æ–∑—Ä–∞—á–µ–Ω, –ª–æ–≥–∏—á–µ–Ω, –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–∞–Ω -->
<Statement>
  <AccountId>BG80BNBG96611020345678</AccountId>
  <Date>2025-10-15</Date>
  <Transaction>
    <Amount>1000.00</Amount>
    <Currency>BGN</Currency>
    <Description>–ü–ª–∞—â–∞–Ω–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç</Description>
    <CounterpartyIBAN>BG22STSA93000020987654</CounterpartyIBAN>
  </Transaction>
</Statement>
```

AI –≤–∏–∂–¥–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ç–∞, –∏–º–∞ XSD —Å—Ö–µ–º–∞, —Ä–∞–∑–±–∏—Ä–∞ –≥–æ –≤–µ–¥–Ω–∞–≥–∞. **–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è: 5 –º–∏–Ω—É—Ç–∏. –ì—Ä–µ—à–∫–∏: 0.**

**–ù–ê–ü —Ñ–æ—Ä–º–∞—Ç (2 –º–µ—Å–µ—Ü–∞ debugging):**

```
BG123456789    –ü–†–ò–ú–ï–†–ù–ê –§–ò–†–ú–ê –û–û–î                                                              20251000000000001400000000000234  1200000.00   240000.00  1200000.00  1200000.00   240000.00         0.00
```

–ö–∞–∫–≤–æ –µ —Ç–æ–≤–∞? –ö—ä–¥–µ —Å–≤—ä—Ä—à–≤–∞ –µ–¥–Ω–æ –ø–æ–ª–µ, –∫—ä–¥–µ –∑–∞–ø–æ—á–≤–∞ –¥—Ä—É–≥–æ? –ö–æ–ª–∫–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞? Windows-1251 –∏–ª–∏ UTF-8? CRLF –∏–ª–∏ LF?

AI –Ω–µ –º–æ–∂–µ –¥–∞ –ø–æ–∑–Ω–∞–µ. –ß–æ–≤–µ–∫ —Ç—Ä—è–±–≤–∞ –¥–∞ **reverse engineer-–Ω–µ** —Ñ–æ—Ä–º–∞—Ç–∞ —á—Ä–µ–∑ –æ–ø–∏—Ç–∏ –∏ –≥—Ä–µ—à–∫–∏. **–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è: 2 –º–µ—Å–µ—Ü–∞. –ì—Ä–µ—à–∫–∏: –±–µ–∑–±—Ä–æ–π.**

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –ù–ê–ü —Ñ–æ—Ä–º–∞—Ç vs SAF-T vs –ë–∞–Ω–∫–æ–≤–∏ XML

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –ù–ê–ü —Ñ–æ—Ä–º–∞—Ç (–ë—ä–ª–≥–∞—Ä–∏—è) | SAF-T (–ï–≤—Ä–æ–ø–∞) | –ë–∞–Ω–∫–æ–≤–∏ XML (MT-940, CAMT.053) |
|----------------|----------------------|----------------|-------------------------------|
| –ì–æ–¥–∏–Ω–∞ –Ω–∞ —Å—ä–∑–¥–∞–≤–∞–Ω–µ | ~1995 | 2005 | 2000+ |
| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | DOS fixed-width —Ç–µ–∫—Å—Ç | XML —Å—ä—Å —Å—Ö–µ–º–∞ | XML —Å—ä—Å —Å—Ö–µ–º–∞ |
| –ö–æ–¥–∏—Ä–∞–Ω–µ | Windows-1251 | UTF-8 | UTF-8 |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | –õ–∏–ø—Å–≤–∞ –ø—É–±–ª–∏—á–Ω–∞ | –ü—ä–ª–Ω–∞, –ø—É–±–ª–∏—á–Ω–∞ | ISO —Å—Ç–∞–Ω–¥–∞—Ä—Ç, –ø—ä–ª–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |
| –í–∞–ª–∏–¥–∞—Ü–∏—è | –°–∞–º–æ –ø—Ä–∏ –∫–∞—á–≤–∞–Ω–µ | XSD —Å—Ö–µ–º–∞, –ª–æ–∫–∞–ª–Ω–∞ | XSD —Å—Ö–µ–º–∞, –ª–æ–∫–∞–ª–Ω–∞ |
| –†–∞–∑—à–∏—Ä—è–µ–º–æ—Å—Ç | –ù–∏–∫–∞–∫–≤–∞ | XML attributes, extensions | XML extensions |
| –ß–æ–≤–µ—à–∫–∞ —á–µ—Ç–∏–º–æ—Å—Ç | –ù–µ–≤—ä–∑–º–æ–∂–Ω–∞ | XML –µ self-documenting | XML –µ self-documenting |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | –§–∞–π–ª–æ–≤–µ | REST API, WebServices | REST API, WebServices |
| **AI —Ä–∞–∑–±–∏—Ä–∞–µ–º–æ—Å—Ç** | ‚ùå **2 –º–µ—Å–µ—Ü–∞ debugging** | ‚úÖ **–ú–∏–Ω—É—Ç–∏** | ‚úÖ **5-6 –º–∏–Ω—É—Ç–∏, –±–µ–∑ –≥—Ä–µ—à–∫–∏** |
| **–í—Ä–µ–º–µ –∑–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è** | ‚ùå **–ú–µ—Å–µ—Ü–∏ –º—ä–∫–∞** | ‚úÖ **–î–Ω–∏** | ‚úÖ **–ú–∏–Ω—É—Ç–∏ —Å AI** |

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:**

–ë–∞–Ω–∫–æ–≤–∏—Ç–µ XML —Ñ–∞–π–ª–æ–≤–µ —Å–∞ **—Ç–æ–ª–∫–æ–≤–∞ –¥–æ–±—Ä–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–∞–Ω–∏**, —á–µ AI –≥–∏ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞ –∑–∞ **5-6 –º–∏–Ω—É—Ç–∏ –ë–ï–ó –¢–ï–°–¢–í–ê–ù–ï** - –≤—Å–∏—á–∫–æ —Ä–∞–±–æ—Ç–∏ –æ—Ç –ø—ä—Ä–≤–∏—è –ø—ä—Ç.

–ù–ê–ü —Ñ–æ—Ä–º–∞—Ç—ä—Ç –µ **—Ç–æ–ª–∫–æ–≤–∞ –∞—Ä—Ö–∞–∏—á–µ–Ω –∏ –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–∞–Ω**, —á–µ –∏–∑–∏—Å–∫–≤–∞ **2 –º–µ—Å–µ—Ü–∞** –º—ä—á–∏—Ç–µ–ª–Ω–æ reverse engineering, –¥–æ—Ä–∏ —Å AI –ø–æ–º–æ—â.

–ù–∏–µ –≤—Å–µ –æ—â–µ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è –Ω–∞ **30 –≥–æ–¥–∏–Ω–∏**, –¥–æ–∫–∞—Ç–æ –ï–≤—Ä–æ–ø–∞ –µ 20 –≥–æ–¥–∏–Ω–∏ –Ω–∞–ø—Ä–µ–¥, –∞ –±–∞–Ω–∫–∏—Ç–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏ –æ—Ç —Å–≤–µ—Ç–æ–≤–Ω–∞—Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞.

## –ö—ä–º –ù–ê–ü: –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∑–∞ –±—ä–¥–µ—â–µ—Ç–æ

–ö–∞—Ç–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏—Ü–∏ –∏ –≥—Ä–∞–∂–¥–∞–Ω–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–º–µ –Ω–∞ –ù–ê–ü:

### 1. –ü—É–±–ª–∏—á–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- –ü—É–±–ª–∏–∫—É–≤–∞–π—Ç–µ **–ø—ä–ª–Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è** –Ω–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ç–µ
- –ù–∞–ø—Ä–∞–≤–µ—Ç–µ **XSD/JSON —Å—Ö–µ–º–∏** –¥–æ—Å—Ç—ä–ø–Ω–∏
- –ü—É–±–ª–∏–∫—É–≤–∞–π—Ç–µ **–ø—Ä–∏–º–µ—Ä–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ** —Å –∫–æ–º–µ–Ω—Ç–∞—Ä–∏
- –°—ä–∑–¥–∞–π—Ç–µ **–ø—É–±–ª–∏—á–µ–Ω –≤–∞–ª–∏–¥–∞—Ç–æ—Ä** (–Ω–µ —Å–∞–º–æ –≤ –ø–æ—Ä—Ç–∞–ª–∞)

### 2. –ú–æ–¥–µ—Ä–µ–Ω API

```javascript
// –í–º–µ—Å—Ç–æ —Ñ–∞–π–ª–æ–≤–µ - REST API
POST https://api.nap.bg/v2/vat/declaration
Content-Type: application/json

{
  "companyVat": "BG123456789",
  "period": "2025-10",
  "sales": [
    {
      "code": "–ø—Ä–æ11",
      "documentType": "01",
      "documentNumber": "0001",
      "date": "2025-10-15",
      "counterpartyVat": "BG987654321",
      "baseAmount": 1000.00,
      "vatAmount": 200.00
    }
  ],
  "purchases": [...]
}
```

### 3. SAF-T —Å—ä–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç

–ë—ä–ª–≥–∞—Ä–∏—è —Ç—Ä—è–±–≤–∞ –¥–∞ –≤—ä–≤–µ–¥–µ **SAF-T** –∫–∞—Ç–æ –æ—Å—Ç–∞–Ω–∞–ª–∞—Ç–∞ —á–∞—Å—Ç –Ω–∞ –ï–°:
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω XML —Ñ–æ—Ä–º–∞—Ç
- –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–∞ —Å—ä–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç
- –í—ä–∑–º–æ–∂–Ω–æ—Å—Ç –∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ AI –∞–Ω–∞–ª–∏–∑
- –õ–µ—Å–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∏

### 4. Open Source –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

–ù–ê–ü –º–æ–∂–µ –¥–∞:
- –ü—É–±–ª–∏–∫—É–≤–∞ **—Ä–µ—Ñ–µ—Ä–µ–Ω—Ç–Ω–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è** (Python/Java/JavaScript)
- –°—ä–∑–¥–∞–¥–µ **npm/pip –ø–∞–∫–µ—Ç–∏** –∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- –ü–æ–¥–¥—ä—Ä–∂–∞ **GitHub repo** —Å –ø—Ä–∏–º–µ—Ä–∏
- –û—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞ **hackathons** –∑–∞ –ø–æ–¥–æ–±—Ä–µ–Ω–∏—è

## –ö–∞–∫ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ RS-AC-BG?

### –ò–Ω—Å—Ç–∞–ª–∞—Ü–∏—è (< 10 –º–∏–Ω—É—Ç–∏)

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–∞–π—Ç–µ (–∫–æ–≥–∞—Ç–æ –±—ä–¥–µ –ø—É–±–ª–∏—á–µ–Ω –≤ repo)
git clone https://github.com/yourusername/rs-ac-bg.git
cd rs-ac-bg

# 2. –°—Ç–∞—Ä—Ç–∏—Ä–∞–π—Ç–µ —Å Docker
docker-compose up -d

# 3. –û—Ç–≤–æ—Ä–µ—Ç–µ –≤ –±—Ä–∞—É–∑—ä—Ä
open http://localhost:5173
```

### –†—ä—á–Ω–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ

```bash
# Backend (Rust)
cd backend
cargo run --release

# Frontend (React)
cd frontend
npm install
npm run dev
```

### –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ

1. **–°—ä–∑–¥–∞–π—Ç–µ –∫–æ–º–ø–∞–Ω–∏—è** - –¥–æ–±–∞–≤–µ—Ç–µ –î–î–° –Ω–æ–º–µ—Ä –∏ –¥–∞–Ω–Ω–∏
2. **–í—ä–≤–µ–¥–µ—Ç–µ –î–î–° –æ–ø–µ—Ä–∞—Ü–∏–∏** - –ø—Ä–æ–¥–∞–∂–±–∏ –∏ –ø–æ–∫—É–ø–∫–∏ —Å –∫–æ–¥–æ–≤–µ
3. **–ì–µ–Ω–µ—Ä–∏—Ä–∞–π—Ç–µ —Ñ–∞–π–ª–æ–≤–µ** - –∏–∑–±–µ—Ä–µ—Ç–µ –º–µ—Å–µ—Ü –∏ download
4. **–ö–∞—á–µ—Ç–µ –≤ –ù–ê–ü** - –ø—Ä–µ–∑ –ø–æ—Ä—Ç–∞–ª–∞ –¥–æ 14-—Ç–æ —á–∏—Å–ª–æ

## Open Source –∏ –¥–æ—Å—Ç—ä–ø–Ω–æ—Å—Ç

RS-AC-BG –µ **–Ω–∞–ø—ä–ª–Ω–æ –±–µ–∑–ø–ª–∞—Ç–µ–Ω** –∏ **open source**:

- **–õ–∏—Ü–µ–Ω–∑:** MIT (–ø—Ä–∞–≤–µ—Ç–µ –∫–∞–∫–≤–æ—Ç–æ –∏—Å–∫–∞—Ç–µ —Å –∫–æ–¥–∞)
- **–ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω –±—Ä–æ–π –∫–æ–º–ø–∞–Ω–∏–∏
- **–ë–µ–∑ vendor lock-in:** –í–∞—à–∏—Ç–µ –¥–∞–Ω–Ω–∏ —Å–∞ –≤–∞—à–∏ (PostgreSQL dump)
- **–ü—ä–ª–µ–Ω –∫–æ–¥:** –í–∏–∂–¥–∞—Ç–µ –≤—Å–∏—á–∫–æ - –Ω—è–º–∞ —Å–∫—Ä–∏—Ç–∏ —á–∞—Å—Ç–∏
- **–û–±—â–Ω–æ—Å—Ç:** GitHub issues, discussions, pull requests

### –ö—ä–¥–µ –¥–∞ –Ω–∞–º–µ—Ä–∏—Ç–µ –∫–æ–¥–∞?

–°–æ—Ñ—Ç—É–µ—Ä—ä—Ç —â–µ –±—ä–¥–µ –ø—É–±–ª–∏–∫—É–≤–∞–Ω –≤ **–æ—Ç–≤–æ—Ä–µ–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** (work in progress):

- **GitLab/GitHub:** [—Å–∫–æ—Ä–æ]
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –í–∏–∂—Ç–µ `/docs` –≤ —Ä–µ–ø–æ—Ç–æ
- **–ü—Ä–∏–º–µ—Ä–∏:** –í–∏–∂—Ç–µ `/examples`

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ: –ö—Ä–∞–π –Ω–∞ –º–æ–Ω–æ–ø–æ–ª–∞ –Ω–∞ –∑–Ω–∞–Ω–∏–µ—Ç–æ

**30 –≥–æ–¥–∏–Ω–∏** –ù–ê–ü —Ñ–æ—Ä–º–∞—Ç—ä—Ç –±–µ—à–µ **—Ç–∞–π–Ω–∞**. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ "–∏–∑–±—Ä–∞–Ω–∏", –ø—Ä–µ–¥–∞–≤–∞–Ω–∞ –ø—Ä–µ–∑ **–ø–ª–∞—Ç–µ–Ω–∏ —Å–µ–º–∏–Ω–∞—Ä–∏** –Ω–∞ –µ–∫—Å–ø–µ—Ä—Ç–∏, –¥–æ—Å—Ç—ä–ø–Ω–∞ —Å–∞–º–æ –Ω–∞ –≥–æ–ª–µ–º–∏—Ç–µ —Å–æ—Ñ—Ç—É–µ—Ä–Ω–∏ —Ñ–∏—Ä–º–∏.

**–î–Ω–µ—Å** –ø—Ä–∞–≤–∏–º —Ç–∞–∑–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è **–Ω–∞–ø—ä–ª–Ω–æ –ø—É–±–ª–∏—á–Ω–∞**. –í—Å–µ–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, –≤—Å—è–∫–∞ –º–∞–ª–∫–∞ —Ñ–∏—Ä–º–∞, –≤—Å–µ–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç –º–æ–∂–µ –¥–∞ —Ä–∞–∑–±–µ—Ä–µ –∫–∞–∫ —Ä–∞–±–æ—Ç–∏ —Ñ–æ—Ä–º–∞—Ç—ä—Ç –∏ –¥–∞ —Å—ä–∑–¥–∞–¥–µ —Å–æ–±—Å—Ç–≤–µ–Ω–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è.

–¢–æ–≤–∞ –Ω–µ –µ –ø—Ä–æ—Å—Ç–æ **—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ blog post**. –¢–æ–≤–∞ –µ **–º–∞–Ω–∏—Ñ–µ—Å—Ç –∑–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç**, –∑–∞ **–¥–µ–º–æ–∫—Ä–∞—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ç–∞**, –∑–∞ **–∫—Ä–∞—è –Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∏—è –º–æ–Ω–æ–ø–æ–ª**.

### –ö–∞–∫–≤–æ –ø–æ—Å—Ç–∏–≥–Ω–∞—Ö–º–µ?

‚úÖ **–†–∞–∑–∫—Ä–∏—Ö–º–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è—Ç–∞** - –ø—ä–ª–Ω–∏ —Ç–∞–±–ª–∏—Ü–∏ —Å –≤—Å–∏—á–∫–∏ –∫–æ–¥–æ–≤–µ
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–∞—Ö–º–µ –∫–∞–ø–∞–Ω–∏—Ç–µ** - CRLF, Windows-1251, —Ñ–∏–∫—Å–∏—Ä–∞–Ω–∞ –¥—ä–ª–∂–∏–Ω–∞
‚úÖ **–ü—É–±–ª–∏–∫—É–≤–∞—Ö–º–µ working code** - Rust –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –≤ RS-AC-BG
‚úÖ **–°—ä–∑–¥–∞–¥–æ—Ö–º–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç** - –±–µ–∑–ø–ª–∞—Ç–µ–Ω, open source, –¥–æ—Å—Ç—ä–ø–µ–Ω –∑–∞ –≤—Å–∏—á–∫–∏
‚úÖ **–î–∞–¥–æ—Ö–º–µ –≥–ª–∞—Å** - –∫—Ä–∏—Ç–∏–∫–∞ –Ω–∞ –æ—Å—Ç–∞—Ä—è–ª–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–∞, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∑–∞ –±—ä–¥–µ—â–µ—Ç–æ

### –ö–∞–∫–≤–æ –æ—á–∞–∫–≤–∞–º–µ –æ—Ç –±—ä–¥–µ—â–µ—Ç–æ?

üîÆ **–ù–ê–ü** –¥–∞ –ø—É–±–ª–∏–∫—É–≤–∞ –æ—Ñ–∏—Ü–∏–∞–ª–Ω–∞, –ø—ä–ª–Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
üîÆ **–ú–æ–¥–µ—Ä–µ–Ω API** –≤–º–µ—Å—Ç–æ DOS —Ñ–∞–π–ª–æ–≤–µ –æ—Ç 90-—Ç–µ
üîÆ **SAF-T** —Å—ä–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç –∫–∞—Ç–æ –≤ –ï–≤—Ä–æ–ø–∞
üîÆ **Open collaboration** –º–µ–∂–¥—É –ù–ê–ü –∏ —Å–æ—Ñ—Ç—É–µ—Ä–Ω–∞—Ç–∞ –∏–Ω–¥—É—Å—Ç—Ä–∏—è

### –ü—Ä–∏—Å—ä–µ–¥–∏–Ω–µ—Ç–µ —Å–µ –∫—ä–º –ø—Ä–æ–º—è–Ω–∞—Ç–∞

- ‚≠ê **Star-–Ω–µ—Ç–µ –ø—Ä–æ–µ–∫—Ç–∞** –∫–æ–≥–∞—Ç–æ –±—ä–¥–µ –ø—É–±–ª–∏–∫—É–≤–∞–Ω
- üêõ **–î–æ–∫–ª–∞–¥–≤–∞–π—Ç–µ –ø—Ä–æ–±–ª–µ–º–∏** - –ø–æ–º–æ–≥–Ω–µ—Ç–µ –¥–∞ —Å—Ç–∞–Ω–µ –ø–æ-–¥–æ–±—ä—Ä
- üí° **–ü—Ä–µ–¥–ª–æ–∂–µ—Ç–µ –ø–æ–¥–æ–±—Ä–µ–Ω–∏—è** - PRs are welcome!
- üì¢ **–°–ø–æ–¥–µ–ª–µ—Ç–µ** - –ø–æ–º–æ–≥–Ω–µ—Ç–µ –Ω–∞ –¥—Ä—É–≥–∏ –¥–∞ –Ω–∞—É—á–∞—Ç

---

**–°—á–µ—Ç–æ–≤–æ–¥—Å—Ç–≤–æ—Ç–æ –Ω–µ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ —á–µ—Ä–Ω–∞ –º–∞–≥–∏—è.**
**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ç–∞ –Ω–µ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ —Ç–∞–π–Ω–∞.**
**–ó–Ω–∞–Ω–∏–µ—Ç–æ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ –¥–æ—Å—Ç—ä–ø–Ω–æ –∑–∞ –≤—Å–∏—á–∫–∏.**

üöÄ **–î–æ–±—Ä–µ –¥–æ—à–ª–∏ –≤ –µ—Ä–∞—Ç–∞ –Ω–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Ç–æ, –æ—Ç–∫—Ä–∏—Ç–æ, –º–æ–¥–µ—Ä–Ω–æ –±—ä–ª–≥–∞—Ä—Å–∫–æ —Å—á–µ—Ç–æ–≤–æ–¥—Å—Ç–≤–æ.**

---

## –†–µ—Å—É—Ä—Å–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### RS-AC-BG –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [VAT System Documentation](../docs/VAT_SYSTEM.md) - –ü—ä–ª–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –î–î–° –º–æ–¥—É–ª–∞
- [NAP Export Guide](../backend/docs/VAT_NAP_EXPORT.md) - –ù–ê–ü –µ–∫—Å–ø–æ—Ä—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
- [Changelog VAT 2.0](../docs/CHANGELOG-VAT-2.0.md) - –ò—Å—Ç–æ—Ä–∏—è –Ω–∞ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ
- [API Documentation](../docs/API.md) - GraphQL API —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏—è

### –í—ä–Ω—à–Ω–∏ —Ä–µ—Å—É—Ä—Å–∏
- [–ó–î–î–° - –ó–∞–∫–æ–Ω –∑–∞ –î–î–°](https://www.lex.bg/laws/ldoc/2135538631)
- [–ü–ü–ó–î–° - –ü—Ä–∞–≤–∏–ª–Ω–∏–∫](https://www.lex.bg/laws/ldoc/2135624088)
- [–ù–ê–ü –ü–æ—Ä—Ç–∞–ª](https://portal.nap.bg)
- [VIES VAT Validation](https://ec.europa.eu/taxation_customs/vies/)

### –°–≤—ä—Ä–∂–µ—Ç–µ —Å–µ —Å –Ω–∞—Å

- **Email:** info@rs-ac-bg.com
- **Issues:** [GitHub/GitLab] (—Å–∫–æ—Ä–æ)
- **Discussions:** [GitHub Discussions] (—Å–∫–æ—Ä–æ)

### –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

–°–ø–µ—Ü–∏–∞–ª–Ω–∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏ –Ω–∞:
- –í—Å–∏—á–∫–∏ —Å—á–µ—Ç–æ–≤–æ–¥–∏—Ç–µ–ª–∏, –∫–æ–∏—Ç–æ —Å–ø–æ–¥–µ–ª–∏—Ö–∞ –æ–ø–∏—Ç –∏ –ø—Ä–æ–±–ª–µ–º–∏
- Open source –æ–±—â–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ Rust –∏ React
- –ù–ê–ü (–∏ –¥–∞, –¥–æ—Ä–∏ —Å –æ—Å—Ç–∞—Ä—è–ª–∏—è —Ñ–æ—Ä–º–∞—Ç, –ø–æ–Ω–µ —Ä–∞–±–æ—Ç–∏ —Å—Ç–∞–±–∏–ª–Ω–æ –æ—Ç 30 –≥–æ–¥–∏–Ω–∏ üòÑ)

---

*–ü–æ—Å–ª–µ–¥–Ω–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è: 11 –æ–∫—Ç–æ–º–≤—Ä–∏ 2025*

*"The best way to predict the future is to implement it." - David Heinemeier Hansson*
