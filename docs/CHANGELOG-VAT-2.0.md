# –î–î–° –ú–æ–¥—É–ª - Changelog v2.0

## [2.0.0] - 2025-10-11

### üéâ –î–æ–±–∞–≤–µ–Ω–æ (Added)

#### Backend - Database Schema

**–ù–æ–≤–∞ –º–∏–≥—Ä–∞—Ü–∏—è:** `m20250101_000001_add_nap_fields_to_vat_returns.rs`

–î–æ–±–∞–≤–µ–Ω–∏ 24 –Ω–æ–≤–∏ –ø–æ–ª–µ—Ç–∞ –≤ —Ç–∞–±–ª–∏—Ü–∞ `vat_returns`:

**–ü—Ä–æ–¥–∞–∂–±–∏ (13 –ø–æ–ª–µ—Ç–∞):**
- `sales_base_20` (decimal 15,2) - –ü–æ–ª–µ 01-11: –î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ 20% (–ø—Ä–æ11)
- `sales_vat_20` (decimal 15,2) - –ü–æ–ª–µ 01-21: –î–î–° 20%
- `sales_base_vop` (decimal 15,2) - –ü–æ–ª–µ 01-12: –í–û–ü –¥–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ (–ø—Ä–æ12)
- `sales_vat_vop` (decimal 15,2) - –ü–æ–ª–µ 01-22: –í–û–ü –î–î–°
- `sales_vat_personal_use` (decimal 15,2) - –ü–æ–ª–µ 01-23: –î–î–° –∑–∞ –ª–∏—á–Ω–æ –ø–æ–ª–∑–≤–∞–Ω–µ
- `sales_base_9` (decimal 15,2) - –ü–æ–ª–µ 01-13: –î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ 9% (–ø—Ä–æ17)
- `sales_vat_9` (decimal 15,2) - –ü–æ–ª–µ 01-24: –î–î–° 9%
- `sales_base_0_art3` (decimal 15,2) - –ü–æ–ª–µ 01-14: –î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ 0% —á–ª.3 (–ø—Ä–æ14)
- `sales_base_0_vod` (decimal 15,2) - –ü–æ–ª–µ 01-15: –î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ 0% –í–û–î (–ø—Ä–æ20)
- `sales_base_0_export` (decimal 15,2) - –ü–æ–ª–µ 01-16: –î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ 0% —á–ª.140/146/173 (–ø—Ä–æ19, –ø—Ä–æ21)
- `sales_base_art21` (decimal 15,2) - –ü–æ–ª–µ 01-17: –î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ —É—Å–ª—É–≥–∏ —á–ª.21 (–ø—Ä–æ22)
- `sales_base_art69` (decimal 15,2) - –ü–æ–ª–µ 01-18: –î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ —á–ª.69 (–ø—Ä–æ23-1, –ø—Ä–æ23-2)
- `sales_base_exempt` (decimal 15,2) - –ü–æ–ª–µ 01-19: –û—Å–≤–æ–±–æ–¥–µ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ (–ø—Ä–æ24-1, –ø—Ä–æ24-2, –ø—Ä–æ24-3)

**–ü–æ–∫—É–ø–∫–∏ (6 –ø–æ–ª–µ—Ç–∞):**
- `purchase_base_no_credit` (decimal 15,2) - –ü–æ–ª–µ 01-30: –î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ –±–µ–∑ –∫—Ä–µ–¥–∏—Ç (–ø–æ–∫09 –±–µ–∑ –ø—Ä–∞–≤–æ)
- `purchase_base_full_credit` (decimal 15,2) - –ü–æ–ª–µ 01-31: –î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ –ø—ä–ª–µ–Ω –∫—Ä–µ–¥–∏—Ç (–ø–æ–∫09, –ø–æ–∫10)
- `purchase_vat_full_credit` (decimal 15,2) - –ü–æ–ª–µ 01-41: –î–î–° –ø—ä–ª–µ–Ω –∫—Ä–µ–¥–∏—Ç
- `purchase_base_partial_credit` (decimal 15,2) - –ü–æ–ª–µ 01-32: –î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ —á–∞—Å—Ç–∏—á–µ–Ω –∫—Ä–µ–¥–∏—Ç (–ø–æ–∫12)
- `purchase_vat_partial_credit` (decimal 15,2) - –ü–æ–ª–µ 01-42: –î–î–° —á–∞—Å—Ç–∏—á–µ–Ω –∫—Ä–µ–¥–∏—Ç
- `purchase_vat_annual_adjustment` (decimal 15,2) - –ü–æ–ª–µ 01-43: –ì–æ–¥–∏—à–Ω–æ –∫–æ—Ä–∏–≥–∏—Ä–∞–Ω–µ (–ø–æ–∫14)

**–†–µ–∑—É–ª—Ç–∞—Ç–Ω–∏ –ø–æ–ª–µ—Ç–∞ (5 –ø–æ–ª–µ—Ç–∞):**
- `credit_coefficient` (decimal 4,2) - –ü–æ–ª–µ 01-33: –ö–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞ —á–∞—Å—Ç–∏—á–µ–Ω –∫—Ä–µ–¥–∏—Ç
- `total_deductible_vat` (decimal 15,2) - –ü–æ–ª–µ 01-40: –û–±—â –¥–∞–Ω—ä—á–µ–Ω –∫—Ä–µ–¥–∏—Ç
- `total_sales_taxable` (decimal 15,2) - –ü–æ–ª–µ 01-01: –û–±—â–∞ –¥–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ –ø—Ä–æ–¥–∞–∂–±–∏
- `total_sales_vat` (decimal 15,2) - –ü–æ–ª–µ 01-20: –û–±—â–æ –Ω–∞—á–∏—Å–ª–µ–Ω –î–î–°
- `sales_document_count` (integer) - –ü–æ–ª–µ 00-05: –ë—Ä–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∏ –ø—Ä–æ–¥–∞–∂–±–∏
- `purchase_document_count` (integer) - –ü–æ–ª–µ 00-06: –ë—Ä–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∏ –ø–æ–∫—É–ø–∫–∏
- `submitted_by_person` (varchar) - –ü–æ–ª–µ 00-04: –ü–æ–¥–∞–≤–∞—â–æ –ª–∏—Ü–µ (–ï–ì–ù/–ò–º–µ)

#### Backend - Entity Model

**–§–∞–π–ª:** `backend/src/entities/vat_return.rs`

- –î–æ–±–∞–≤–µ–Ω–∏ –≤—Å–∏—á–∫–∏ –Ω–æ–≤–∏ –ø–æ–ª–µ—Ç–∞ –≤ `Model` —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ç–∞
- –î–æ–±–∞–≤–µ–Ω–∏ `#[sea_orm(column_name = "...")]` –∞—Ç—Ä–∏–±—É—Ç–∏ –∑–∞ –ø–æ–ª–µ—Ç–∞ —Å —Ä–∞–∑–ª–∏—á–Ω–∏ –∏–º–µ–Ω–∞ –≤ –±–∞–∑–∞—Ç–∞
- –î–µ—Ç–∞–π–ª–Ω–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä–∏ –∑–∞ –≤—Å—è–∫–æ –ø–æ–ª–µ —Å –ø—Ä–µ–ø—Ä–∞—Ç–∫–∞ –∫—ä–º NAP —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è—Ç–∞
- –ó–∞–ø–∞–∑–µ–Ω–∏ —Å—Ç–∞—Ä–∏ –ø–æ–ª–µ—Ç–∞ –∑–∞ backward compatibility (–º–∞—Ä–∫–∏—Ä–∞–Ω–∏ –∫–∞—Ç–æ "Legacy fields")

#### Frontend - VATEntry Form

**–§–∞–π–ª:** `frontend/src/pages/VATEntry.jsx`

**–ù–æ–≤–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∏ –∫–æ–¥–æ–≤–µ —Å–ø–æ—Ä–µ–¥ koloni-vat.pdf:**

–ü–æ–∫—É–ø–∫–∏:
- `–ø–æ–∫09` - –î–æ—Å—Ç–∞–≤–∫–∏, –í–û–ü, –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–æ —á–ª.82, –∞–ª.2-4 –∏ –≤–Ω–æ—Å –ë–ï–ó –ø—Ä–∞–≤–æ –Ω–∞ –î–ö
- `–ø–æ–∫10` - –û–±–ª–∞–≥–∞–µ–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏, –í–û–ü, –≤–Ω–æ—Å —Å –ø—Ä–∞–≤–æ –Ω–∞ –ü–™–õ–ï–ù –î–ö
- `–ø–æ–∫12` - –û–±–ª–∞–≥–∞–µ–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏, –í–û–ü, –≤–Ω–æ—Å —Å –ø—Ä–∞–≤–æ –Ω–∞ –ß–ê–°–¢–ò–ß–ï–ù –î–ö
- `–ø–æ–∫14` - –ì–æ–¥–∏—à–Ω–∞ –∫–æ—Ä–µ–∫—Ü–∏—è –ø–æ —á–ª.73, –∞–ª.8 –ó–î–î–°
- `–ø–æ–∫15` - –ü—Ä–∏–¥–æ–±–∏–≤–∞–Ω–µ –Ω–∞ —Å—Ç–æ–∫–∏ –æ—Ç –ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –≤ —Ç—Ä–∏—Å—Ç—Ä–∞–Ω–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è

–ü—Ä–æ–¥–∞–∂–±–∏:
- `–ø—Ä–æ11` - –û–±–ª–∞–≥–∞–µ–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ —Å—ä—Å —Å—Ç–∞–≤–∫–∞ 20%
- `–ø—Ä–æ12` - –ù–∞—á–∏—Å–ª–µ–Ω –¥–∞–Ω—ä–∫ (20%) –ø—Ä–µ–¥–≤–∏–¥–µ–Ω –≤ –∑–∞–∫–æ–Ω–∞ –≤ –¥—Ä—É–≥–∏ —Å–ª—É—á–∞–∏
- `–ø—Ä–æ13` - –í–û–ü
- `–ø—Ä–æ14` - –ü–æ–ª—É—á–µ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–æ —á–ª.82, –∞–ª.2-4 –ó–î–î–°
- `–ø—Ä–æ16` - –ù–∞—á–∏—Å–ª–µ–Ω –¥–∞–Ω—ä–∫ –∑–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –∑–∞ –ª–∏—á–Ω–∏ –Ω—É–∂–¥–∏
- `–ø—Ä–æ17` - –û–±–ª–∞–≥–∞–µ–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ —Å—ä—Å —Å—Ç–∞–≤–∫–∞ 9%
- `–ø—Ä–æ19` - –î–æ—Å—Ç–∞–≤–∫–∏ —Å—ä—Å —Å—Ç–∞–≤–∫–∞ 0% –ø–æ –≥–ª–∞–≤–∞ 3-—Ç–∞ –æ—Ç –ó–î–î–°
- `–ø—Ä–æ20` - –í–û–î (–∫3 VIES)
- `–ø—Ä–æ21` - –î–æ—Å—Ç–∞–≤–∫–∏ –ø–æ —á–ª.140, 146, 173 –ó–î–î–°
- `–ø—Ä–æ22` - –î–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ —É—Å–ª—É–≥–∏ –ø–æ —á–ª.21, –∞–ª.2 (–∫—ä–º –¥—Ä—É–≥–∞ –¥—ä—Ä–∂–∞–≤–∞ –ï–°)
- `–ø—Ä–æ23-1` - –î–æ—Å—Ç–∞–≤–∫–∏ –ø–æ —á–ª.69, –∞–ª.2 –∏ –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–∏ –ø—Ä–æ–¥–∞–∂–±–∏
- `–ø—Ä–æ23-2` - –î–æ—Å—Ç–∞–≤–∫–∏ (–¥–∞–Ω. –æ—Å–Ω–æ–≤–∞ –∏ –î–î–°) –ø—Ä–∏ –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–∏ –ø—Ä–æ–¥–∞–∂–±–∏
- `–ø—Ä–æ24-1` - –û—Å–≤–æ–±–æ–¥–µ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ —Å—Ç—Ä–∞–Ω–∞—Ç–∞ –∏ –æ—Å–≤–æ–±–æ–¥–µ–Ω–∏ –í–û–ü
- `–ø—Ä–æ24-2` - –û—Å–≤–æ–±–æ–¥–µ–Ω–∏ –í–û–î (–∫3 VIES)
- `–ø—Ä–æ24-3` - –û—Å–≤–æ–±–æ–¥–µ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ —É—Å–ª—É–≥–∏ –ø–æ —á–ª.21, –∞–ª.2 (–∫5 VIES)
- `–ø—Ä–æ25` - –î–æ—Å—Ç–∞–≤–∫–∏ –∫–∞—Ç–æ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –≤ —Ç—Ä–∏—Å—Ç—Ä–∞–Ω–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–∫4 VIES)

**–ò–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏:**
- –¶–≤–µ—Ç–Ω–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ –∑–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ —Ç–∏–ø–æ–≤–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–µ–¥–ª–∞–≥–∞–Ω–µ –Ω–∞ –î–î–° —Å—Ç–∞–≤–∫–∞ —Å–ø–æ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏—è—Ç–∞
- –í–∏–∑—É–∞–ª–Ω–∏ –∏–∫–æ–Ω–∫–∏ (üü¢ –ø—ä–ª–µ–Ω –î–ö, üü† —á–∞—Å—Ç–∏—á–µ–Ω –î–ö, üî¥ –±–µ–∑ –î–ö, üá™üá∫ –í–û–î/–í–û–ü)
- Real-time –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏

**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:**
- useEffect –∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–µ–¥–ª–∞–≥–∞–Ω–µ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–∏ –ø—Ä–æ–º—è–Ω–∞ –Ω–∞ –î–î–° —Å—Ç–∞–≤–∫–∞
- 20% ‚Üí –ø—Ä–æ11 (–ø—Ä–æ–¥–∞–∂–±–∏) –∏–ª–∏ –ø–æ–∫10 (–ø–æ–∫—É–ø–∫–∏)
- 9% ‚Üí –ø—Ä–æ17 (–ø—Ä–æ–¥–∞–∂–±–∏) –∏–ª–∏ –ø–æ–∫10 (–ø–æ–∫—É–ø–∫–∏)
- 0% ‚Üí –ø—Ä–æ19 (–ø—Ä–æ–¥–∞–∂–±–∏)

#### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `docs/VAT-MODULE.md` - –ü—ä–ª–Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `docs/VAT-QUICK-REFERENCE.md` - –ë—ä—Ä–∑–∞ —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏—è –∑–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏
- `docs/CHANGELOG-VAT-2.0.md` - –¢–æ–∑–∏ —Ñ–∞–π–ª

### üîß –ü—Ä–æ–º–µ–Ω–µ–Ω–æ (Changed)

#### Database

- –ö–æ–ª–æ–Ω–∏—Ç–µ –≤ –±–∞–∑–∞—Ç–∞ –¥–∞–Ω–Ω–∏ –∏–∑–ø–æ–ª–∑–≤–∞—Ç naming convention –±–µ–∑ –¥–æ–ª–Ω–∏ —á–µ—Ä—Ç–∏ (–Ω–∞–ø—Ä. `sales_base20` –≤–º–µ—Å—Ç–æ `sales_base_20`)
- Entity –º–æ–¥–µ–ª–∞ –∏–∑–ø–æ–ª–∑–≤–∞ –¥–æ–ª–Ω–∏ —á–µ—Ä—Ç–∏ –∑–∞ –ø–æ-–¥–æ–±—Ä–∞ —á–µ—Ç–ª–∏–≤–æ—Å—Ç –Ω–∞ Rust –∫–æ–¥–∞
- Mapping –º–µ–∂–¥—É –¥–≤–µ—Ç–µ —Å–µ –ø—Ä–∞–≤–∏ —á—Ä–µ–∑ `#[sea_orm(column_name = "...")]`

#### Frontend

- –ü–æ-—à–∏—Ä–æ–∫–∏ select –ø–æ–ª–µ—Ç–∞ –∑–∞ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∏—Ç–µ –∫–æ–¥–æ–≤–µ (col-span-2)
- –ü–æ–¥–æ–±—Ä–µ–Ω layout –Ω–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –∑–∞ –≤—ä–≤–µ–∂–¥–∞–Ω–µ
- –ü–æ-–¥–µ—Ç–∞–π–ª–Ω–∏ –æ–±—è—Å–Ω–µ–Ω–∏—è –Ω–∞ –≤—Å—è–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –≤ dropdown –º–µ–Ω—é—Ç–∞—Ç–∞

### üêõ –ü–æ–ø—Ä–∞–≤–µ–Ω–æ (Fixed)

#### Backend

- –ü–æ–ø—Ä–∞–≤–µ–Ω –ø—Ä–æ–±–ª–µ–º —Å –ª–∏–ø—Å–≤–∞—â–∏ –∫–æ–ª–æ–Ω–∏ –ø—Ä–∏ query –Ω–∞ `vat_returns`
- –î–æ–±–∞–≤–µ–Ω–∏ –ø—Ä–∞–≤–∏–ª–Ω–∏ column mappings –∑–∞ –≤—Å–∏—á–∫–∏ –ø–æ–ª–µ—Ç–∞

#### Frontend

- –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∏ –∫–æ–¥–æ–≤–µ –¥–∞ —Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∞—Ç –Ω–∞ NAP —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è—Ç–∞
- –ü–æ–ø—Ä–∞–≤–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–µ–¥–ª–∞–≥–∞–Ω–µ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏

### üóëÔ∏è Deprecated

- –°—Ç–∞—Ä–∏ –ø–æ–ª–µ—Ç–∞ (`base_amount_20`, `vat_amount_20` –∏ —Ç.–Ω.) —Å–∞ –º–∞—Ä–∫–∏—Ä–∞–Ω–∏ –∫–∞—Ç–æ "Legacy" –Ω–æ –∑–∞–ø–∞–∑–µ–Ω–∏ –∑–∞ backward compatibility
- –ü—Ä–µ–ø–æ—Ä—ä—á–≤–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ –Ω–æ–≤–∏—Ç–µ –ø–æ–ª–µ—Ç–∞ –∑–∞ –≤—Å–∏—á–∫–∏ –Ω–æ–≤–∏ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏

### ‚ö†Ô∏è Breaking Changes

**–ù–ï –°–ê –ò–ó–í–™–†–®–ï–ù–ò BREAKING CHANGES!**

–í—Å–∏—á–∫–∏ —Å—Ç–∞—Ä–∏ –ø–æ–ª–µ—Ç–∞ —Å–∞ –∑–∞–ø–∞–∑–µ–Ω–∏. –ù–æ–≤–∏—Ç–µ –ø–æ–ª–µ—Ç–∞ —Å–∞ –¥–æ–±–∞–≤–µ–Ω–∏ –∫–∞—Ç–æ –¥–æ–ø—ä–ª–Ω–µ–Ω–∏–µ.

–ó–∞ –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ —Å—Ç–∞—Ä–∏ –¥–∞–Ω–Ω–∏ –∫—ä–º –Ω–æ–≤–∏—è —Ñ–æ—Ä–º–∞—Ç:
```sql
-- –ü—Ä–∏–º–µ—Ä: –ö–æ–ø–∏—Ä–∞–Ω–µ –Ω–∞ —Å—Ç–∞—Ä–∏ –¥–∞–Ω–Ω–∏ –≤ –Ω–æ–≤–∏—Ç–µ –ø–æ–ª–µ—Ç–∞
UPDATE vat_returns SET
  sales_base_20 = base_amount20,
  sales_vat_20 = vat_amount20,
  sales_base_9 = base_amount9,
  sales_vat_9 = vat_amount9,
  total_sales_taxable = base_amount20 + base_amount9 + base_amount0,
  total_sales_vat = vat_amount20 + vat_amount9;
```

### üìã Migration Path

#### –°—Ç—ä–ø–∫–∏ –∑–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç v1.x –¥–æ v2.0:

1. **Backup –±–∞–∑–∞ –¥–∞–Ω–Ω–∏:**
   ```bash
   pg_dump rs-ac-bg > backup_$(date +%Y%m%d).sql
   ```

2. **–°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –º–∏–≥—Ä–∞—Ü–∏–∏:**
   ```bash
   cargo run --package migration -- up
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–æ–≤–∏—Ç–µ –ø–æ–ª–µ—Ç–∞:**
   ```bash
   psql rs-ac-bg -c "\d vat_returns"
   ```

4. **Rebuild backend:**
   ```bash
   cargo build --release
   ```

5. **Rebuild frontend:**
   ```bash
   cd frontend && npm run build
   ```

6. **–†–µ—Å—Ç–∞—Ä—Ç –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∏—Ç–µ**

7. **–¢–µ—Å—Ç –Ω–∞ –Ω–æ–≤–∞ –î–î–° –æ–ø–µ—Ä–∞—Ü–∏—è**

8. **(–û–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ) –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ —Å—Ç–∞—Ä–∏ –¥–∞–Ω–Ω–∏** - –≤–∏–∂ SQL —Å–∫—Ä–∏–ø—Ç –ø–æ-–≥–æ—Ä–µ

### üîç Testing

**–¢–µ—Å—Ç–≤–∞–Ω–∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**

‚úÖ –ö–æ–º–ø–∏–ª–∞—Ü–∏—è –Ω–∞ backend –±–µ–∑ –≥—Ä–µ—à–∫–∏
‚úÖ –ö–æ–º–ø–∏–ª–∞—Ü–∏—è –Ω–∞ frontend –±–µ–∑ –≥—Ä–µ—à–∫–∏
‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è—Ç–∞ —Å–µ –∏–∑–ø—ä–ª–Ω—è–≤–∞ —É—Å–ø–µ—à–Ω–æ
‚úÖ –í—Å–∏—á–∫–∏ –Ω–æ–≤–∏ –ø–æ–ª–µ—Ç–∞ —Å–∞ –¥–æ—Å—Ç—ä–ø–Ω–∏ –≤ –±–∞–∑–∞—Ç–∞
‚úÖ Entity –º–æ–¥–µ–ª–∞ —Ä–∞–±–æ—Ç–∏ –ø—Ä–∞–≤–∏–ª–Ω–æ —Å –Ω–æ–≤–∏—Ç–µ –ø–æ–ª–µ—Ç–∞
‚úÖ VATEntry —Ñ–æ—Ä–º–∞ –ø–æ–∫–∞–∑–≤–∞ –Ω–æ–≤–∏—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∏ –∫–æ–¥–æ–≤–µ
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç—è—Ç –∫–æ—Ä–µ–∫—Ç–Ω–æ

**–ü—Ä–µ–¥—Å—Ç–æ–∏ —Ç–µ—Å—Ç–≤–∞–Ω–µ:**

‚è≥ –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ NAP DEKLAR.TXT —Ñ–∞–π–ª —Å –Ω–æ–≤–∏—Ç–µ –ø–æ–ª–µ—Ç–∞
‚è≥ –ï–∫—Å–ø–æ—Ä—Ç –Ω–∞ PRODAGBI.TXT —Å –ø—Ä–∞–≤–∏–ª–Ω–∏ –∫–æ–ª–æ–Ω–Ω–∏ –∫–æ–¥–æ–≤–µ
‚è≥ –ï–∫—Å–ø–æ—Ä—Ç –Ω–∞ POKUPKI.TXT —Å –ø—Ä–∞–≤–∏–ª–Ω–∏ –∫–æ–ª–æ–Ω–Ω–∏ –∫–æ–¥–æ–≤–µ
‚è≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å VIES –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è
‚è≥ –¢–µ—Å—Ç–≤–∞–Ω–µ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ –î–î–° —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–í–û–î, –í–û–ü, —á–∞—Å—Ç–∏—á–µ–Ω –î–ö)

### üì¶ Dependencies

**–ë–µ–∑ –ø—Ä–æ–º–µ–Ω–∏ –≤ dependencies.**

–ò–∑–ø–æ–ª–∑–≤–∞—Ç —Å–µ —Å—ä—â–∏—Ç–µ –≤–µ—Ä—Å–∏–∏ –Ω–∞:
- sea-orm
- async-graphql
- react
- vite

### üéØ Performance

**–í—ä–∑–¥–µ–π—Å—Ç–≤–∏–µ –≤—ä—Ä—Ö—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç—Ç–∞:**

- –î–æ–±–∞–≤–µ–Ω–∏ 24 –Ω–æ–≤–∏ –∫–æ–ª–æ–Ω–∏ –≤ `vat_returns` —Ç–∞–±–ª–∏—Ü–∞
- –†–∞–∑–º–µ—Ä –Ω–∞ –∑–∞–ø–∏—Å: +192 bytes (24 √ó 8 bytes –∑–∞ decimal –ø–æ–ª–µ—Ç–∞)
- –û—á–∞–∫–≤–∞–Ω performance impact: **–º–∏–Ω–∏–º–∞–ª–µ–Ω** (< 1%)
- Index —Å—Ç—Ä—É–∫—Ç—É—Ä–∏: **–±–µ–∑ –ø—Ä–æ–º—è–Ω–∞**

### üîê Security

**–ë–µ–∑ –ø—Ä–æ–º–µ–Ω–∏ –≤ security.**

–í—Å–∏—á–∫–∏ –Ω–æ–≤–∏ –ø–æ–ª–µ—Ç–∞ —Å–ª–µ–¥–≤–∞—Ç —Å—ä—â–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –∑–∞ –¥–æ—Å—Ç—ä–ø –∫–∞—Ç–æ —Å—Ç–∞—Ä–∏—Ç–µ.

### üìä Database Schema Changes

```sql
-- –û—Å–Ω–æ–≤–Ω–∏ –ø—Ä–æ–º–µ–Ω–∏ –≤ —Ç–∞–±–ª–∏—Ü–∞ vat_returns
ALTER TABLE vat_returns ADD COLUMN sales_base20 NUMERIC(15,2) DEFAULT 0 NOT NULL;
ALTER TABLE vat_returns ADD COLUMN sales_vat20 NUMERIC(15,2) DEFAULT 0 NOT NULL;
-- ... (–≤–∏–∂—Ç–µ –ø—ä–ª–Ω–∞—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏—è –∑–∞ –≤—Å–∏—á–∫–∏ –ø–æ–ª–µ—Ç–∞)
```

**–†–∞–∑–º–µ—Ä –Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–µ–¥–∏/—Å–ª–µ–¥:**
- –ü—Ä–µ–¥–∏: ~25 –∫–æ–ª–æ–Ω–∏
- –°–ª–µ–¥: ~49 –∫–æ–ª–æ–Ω–∏
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ: +24 –∫–æ–ª–æ–Ω–∏ (+96%)

### üåç Internationalization

**–ï–∑–∏–∫:** –ë—ä–ª–≥–∞—Ä—Å–∫–∏

–í—Å–∏—á–∫–∏ –Ω–æ–≤–∏ —Ç–µ–∫—Å—Ç–æ–≤–µ —Å–∞ –Ω–∞ –±—ä–ª–≥–∞—Ä—Å–∫–∏ –µ–∑–∏–∫ —Å–ø–æ—Ä–µ–¥ NAP –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è—Ç–∞.

### üìö References

- [NAP PPDDS_2025 –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è](../new-vat-nap/PPDDS_2025_.html)
- [–ö–æ–ª–æ–Ω–Ω–∏ –∫–æ–¥–æ–≤–µ](../new-vat-nap/koloni-vat.pdf)
- [–ó–î–î–°](https://www.lex.bg/laws/ldoc/2135538631)
- [–ü–ü–ó–î–°](https://www.lex.bg/laws/ldoc/2135624088)

### üë• Contributors

- Claude (Anthropic) - –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ v2.0
- DVG - Project owner –∏ —Ç–µ—Å—Ç–≤–∞–Ω–µ

### üìù Notes

**–í–∞–∂–Ω–æ:**
- –î–î–° –¥–∞—Ç–∞—Ç–∞ (`vat_date`) –µ –∫—Ä–∏—Ç–∏—á–Ω–∞ –∑–∞ –ø—Ä–∞–≤–∏–ª–Ω–æ—Ç–æ –ø–æ–ø–∞–¥–∞–Ω–µ –≤ –æ—Ç—á–µ—Ç–µ–Ω –ø–µ—Ä–∏–æ–¥
- –ü—Ä–µ–ø–æ—Ä—ä—á–≤–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ –Ω–æ–≤–∏—Ç–µ –∫–æ–¥–æ–≤–µ (–ø—Ä–æ11, –ø–æ–∫10 –∏ —Ç.–Ω.) –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ä–∏—Ç–µ —Ü–∏—Ñ—Ä–æ–≤–∏ –∫–æ–¥–æ–≤–µ
- –ó–∞ –í–û–î/–í–û–ü –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–∏–Ω–∞–≥–∏ –ø—Ä–æ–≤–µ—Ä—è–≤–∞–π—Ç–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –î–î–° –Ω–æ–º–µ—Ä–∞ –≤ VIES —Å–∏—Å—Ç–µ–º–∞

**–ò–∑–≤–µ—Å—Ç–Ω–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ö–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç—ä—Ç –∑–∞ —á–∞—Å—Ç–∏—á–µ–Ω –î–ö (–ø–æ–∫12) —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –∏–∑—á–∏—Å–ª—è–≤–∞ —Ä—ä—á–Ω–æ
- VIES –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è —Å–µ –≥–µ–Ω–µ—Ä–∏—Ä–∞ –æ—Ç–¥–µ–ª–Ω–æ –æ—Ç NAP —Ñ–∞–π–ª–æ–≤–µ—Ç–µ
- –ü–æ–¥–ø–∏—Å–≤–∞–Ω–µ—Ç–æ –Ω–∞ NAP —Ñ–∞–π–ª–æ–≤–µ —Å –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–∞–Ω –µ–ª–µ–∫—Ç—Ä–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å –Ω–µ –µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω–æ

### üöÄ Future Plans (v2.1)

–ü–ª–∞–Ω–∏—Ä–∞–Ω–∏ –ø–æ–¥–æ–±—Ä–µ–Ω–∏—è –∑–∞ —Å–ª–µ–¥–≤–∞—â–∞ –≤–µ—Ä—Å–∏—è:

- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞ —á–∞—Å—Ç–∏—á–µ–Ω –î–ö
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–∞–Ω VIES –≤–∞–ª–∏–¥–∞—Ç–æ—Ä
- [ ] –ï–∫—Å–ø–æ—Ä—Ç –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤ XML —Ñ–æ—Ä–º–∞—Ç (–Ω–æ–≤–∞ NAP —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è)
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ–ø—ä–ª–≤–∞–Ω–µ –Ω–∞ —Å—á–µ—Ç–æ–≤–æ–¥–Ω–∏ –∑–∞–ø–∏—Å–∏ —Å–ø–æ—Ä–µ–¥ —à–∞–±–ª–æ–Ω–∏
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –µ-—Ñ–∞–∫—Ç—É—Ä–∏—Ä–∞–Ω–µ
- [ ] –ü–æ–¥–ø–∏—Å–≤–∞–Ω–µ –Ω–∞ NAP —Ñ–∞–π–ª–æ–≤–µ —Å –ö–ï–ü
- [ ] Import –Ω–∞ —Å—Ç–∞—Ä–∏ NAP —Ñ–∞–π–ª–æ–≤–µ

---

**–í–µ—Ä—Å–∏—è:** 2.0.0
**–î–∞—Ç–∞ –Ω–∞ –∏–∑–¥–∞–≤–∞–Ω–µ:** 11 –æ–∫—Ç–æ–º–≤—Ä–∏ 2025
**–°—Ç–∞—Ç—É—Å:** Stable
**–°—ä–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç:** NAP PPDDS_2025, –ó–î–î–° (2024)
