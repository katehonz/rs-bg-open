# AI Document Recognition Import Format

## Обща информация

Този формат е предназначен за импорт на фактури и счетоводни документи, разпознати от AI системи за обработка на документи. Форматът поддържа покупки, продажби, кредитни/дебитни известия и протоколи с пълна ДДС информация според българското законодателство.

## Структура на папката

```
z-import-format/
├── README.md                          # Тази документация
├── schema.json                        # JSON Schema за валидация
├── examples/
│   ├── purchase-invoice.json         # Примерна фактура покупка
│   ├── sale-invoice.json            # Примерна фактура продажба
│   ├── credit-note.json             # Примерно кредитно известие
│   └── protocol.json                # Примерен протокол по чл.117
├── vat-operations.md                 # ДДС операции и кодове
└── validation-rules.md              # Валидационни правила

```

## Основни характеристики

### Поддържани типове документи
- **INVOICE** - Фактура
- **CREDIT_NOTE** - Кредитно известие
- **DEBIT_NOTE** - Дебитно известие
- **PROTOCOL** - Протокол по чл.117

### Типове транзакции
- **PURCHASE** - Покупка (ДДС регистър 1)
- **SALE** - Продажба (ДДС регистър 2)

### Ключови полета

#### Документ
- `documentType` - Тип на документа
- `transactionType` - Покупка или продажба
- `documentNumber` - Номер на документа
- `documentDate` - Дата на издаване
- `dueDate` - Дата на падеж

#### Контрагент
- `name` - Име на фирмата
- `eik` - БУЛСТАТ/ЕИК
- `vatNumber` - ДДС номер (формат: BG + 9 цифри)
- `isVatRegistered` - Регистрация по ДДС

#### Суми
- `netAmount` - Данъчна основа
- `vatAmount` - ДДС сума
- `totalAmount` - Обща сума с ДДС

#### ДДС детайли
- `vatRegister` - 1 за покупки, 2 за продажби
- `vatPeriod` - Данъчен период (YYYY-MM)
- `operations` - Масив с ДДС операции
  - `operationCode` - Код според ЗДДС
  - `taxBase` - Данъчна основа
  - `vatRate` - ДДС ставка (0, 9, 20)
  - `vatAmount` - ДДС сума

#### AI разпознаване
- `confidence` - Обща увереност (0-1)
- `recognizedFields` - Увереност по полета
- `warnings` - Предупреждения
- `needsReview` - Нужда от ръчен преглед

## Използване

### 1. Подготовка на JSON файл
Създайте JSON файл според схемата в `schema.json`. Вижте примерите в папка `examples/`.

### 2. Валидация
Валидирайте JSON файла спрямо схемата преди импорт.

### 3. Импорт в счетоводната система
Системата ще:
- Валидира данните
- Създаде контрагенти (ако не съществуват)
- Генерира счетоводни записи
- Обработи ДДС информацията
- Покаже резултати за преглед

### 4. Преглед и корекции
При нужда от корекции:
- Прегледайте `warnings` и `needsReview` полетата
- Коригирайте сметките чрез `mappingRules`
- Проверете ДДС операциите

## Интеграция с AI системи

### Изисквания към AI системата
1. Разпознаване на тип документ (фактура/кредитно известие)
2. Определяне на тип транзакция (покупка/продажба)
3. Извличане на контрагент информация
4. Точно разпознаване на суми и ДДС
5. Confidence scores за всяко поле

### Препоръчителни confidence прагове
- Документ номер: > 0.95
- Суми: > 0.98
- Контрагент: > 0.90
- ДДС операции: > 0.92

## Съответствие със законодателството

Форматът е съобразен с:
- Закон за ДДС (ЗДДС)
- Правилник за прилагане на ЗДДС (ППЗДДС)
- Изисквания на НАП за ДДС декларации
- Счетоводни стандарти (НСС/МСС)

## Поддръжка

За въпроси и проблеми:
1. Проверете `validation-rules.md` за валидационни правила
2. Прегледайте `vat-operations.md` за ДДС кодове
3. Вижте примерите в папка `examples/`

## Версии

- **v1.0** - Първоначална версия с базова функционалност
- Бъдещи подобрения:
  - Поддръжка за митнически декларации
  - Разширени аналитични полета
  - Batch импорт оптимизации